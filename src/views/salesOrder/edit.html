
<div class="api_demo" ng-controller="salesOrderEditCtrl" >
  <div class="page-main"    ajax-url="rest/authen/salesOrder/getOfEdit.json?id={{mainStatus.pageParams.id}}"  scope-data="formData" alert-error
 >
          <div class="mgb-l"><span class="text-l">表单元素</span></div>
          <form id="addSalesOrderForm"

 form-validator  parameter-body action="rest/authen/salesOrder/save.json"
           alert-error alert-ok scope-error-msg="errorMsg">


            <div class="form-tr">
                <div class="form-th">订单类型</div>
                <div class="form-td">

                    <select class="select" ng-model="formData.type">
                        <option value="普通订单">普通订单</option>
                        <option value="紧急订单">紧急订单</option>
                    </select>

                </div>
            </div>

              <div class="form-tr">
                  <div class="form-th">客户名</div>
                  <div class="form-td">
                    <select class="select select-w" data-placeholder="选择一个..." chosen  ng-model="formData.customerId" select-source="rest/authen/customerAddress/queryForSelectOption.json"></select>

                  </div>
              </div>

              <div class="form-tr" ajax-if="{{formData.customerId}}"  ajax-url="rest/authen/customerAddress/get.json?id={{formData.customerId}}" scope-data="customerAddress"  callback="formData.customerName=customerAddress.name;formData.address=customerAddress.contacts[0]">

                  <div class="form-th">收货人信息</div>
                  <ul ng-if="customerAddress&&customerAddress.contacts">

                      <li>
                        <label class="radio-inline" ng-repeat="item in customerAddress.contacts">
                          <input name="display" type="radio" value="{{item.id}}" ng-model="formData.contactsId"  ng-checked="item.id==formData.address.id" required>{{item.name}} {{item.address}} {{item.tel}}
                        </label>
                      </li>

                  </ul>

              </div>
              <div class="form-tr">
                <div class="form-th">对应销售人员</div>
                <div class="form-td" >
                  <select class="select select-w" data-placeholder="选择一个..." chosen default-empty="无"  ng-model="formData.saleUserId" select-source="rest/authen/user/queryForSelectOption.json">
                    <option value=""></option>
                  </select>

                </div>
                  <div class="form-th">期望日期</div>
                  <div class="form-td" >
                      <input type="date" class="ipt" convert-to-date ng-model="formData.expectDate" />
                  </div>
              </div>
              <div class="form-tr">
                  <div class="form-th">备注</div>
                  <div class="form-td" >
                    <textarea ng-model="formData.note"></textarea>
                  </div>
              </div>


              <!-- 订单列表 -->
              <div class="form-tr"  >
                  <div class="form-th">订单列表</div>

                  <table class="table-list">
                      <thead>
                      <tr>
                          <th><input type="checkbox" class="selectAll"></th>
                          <th >药品</th>
                          <th >厂家</th>
                          <!-- <th>规格</th> -->
                          <th>单位</th>
                          <th>价格</th>
                            <th>需要同批次</th>
                          <th>数量</th>
                            <th>操作</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr ng-repeat="tr in formData.orderMedicalNos" ng-click="selectThis()">
                          <td class="select-td"><input type="checkbox" class="selectOne" value="{{tr.relId}}"></td>
                          <td>

                            {{tr.medical.name}}
                          </td>
                          <td>{{tr.medical.brand}}</td>
                          <td>{{tr.medical.unit}}</td>
                          <td>{{tr.medical.price}}</td>
                          <td>
                                <input type="checkbox" ng-true-value="'是'" ng-false-value="'否'"   ng-model="tr.isSameBatch"/>
                          </td>
                          <td>
                              <input type="text" class="ipt" ng-model="tr.quantity" />
                          </td>
                          <td>

                              <button type="button" class="btn btn-s btn-orange" ng-click="formData.orderMedicalNos.splice($index,1)"><i class="iconfont icon-delete"></i> 删除</button>
                          </td>
                      </tr>
                      </tbody>
                  </table>
              </div>

                  <!-- 订单列表 -->

                  <!-- 添加订单 -->
                  <div class="form-tr"  ng-init="addDataItem={}">

                      <table class="table-list">
                          <thead>
                          <tr>
                              <th >药名</th>
                              <th >厂家</th>
                              <th>规格</th>
                                <th>单位</th>
                              <th>参考价格</th>
                              <th>需要同批次</th>
                              <th>购买数量</th>
                                <th>操作</th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr ajax-if="{{addDataItem.relId}}"  ajax-url="rest/authen/medical/get.json?id={{addDataItem.relId}}" scope-data="medical"
                            callback="selectRelIdCallBack(medical)">
                              <td>
                                <select id="addDataItem_relId" class="select select-w" data-placeholder="选择一个..." chosen
                                ng-model="addDataItem.relId"
                                select-source="rest/authen/medical/queryForSelectOption.json"></select>
                              </td>
                              <td>{{addDataItem.brand}}</td>
                              <td>规格</td>
                              <td>{{addDataItem.unit}}</td>
                              <td>{{addDataItem.price}}</td>

                              <td>
                                    <input type="checkbox"  ng-true-value="'是'" ng-false-value="'否'"   ng-model="addDataItem.isSameBatch" />
                              </td>
                              <td>
                                  <input type="text" id="addDataItem_quantity" class="ipt" ng-model="addDataItem.quantity"  ng-keydown="$event.keyCode==13&&addDataItemClick()"/>
                              </td>

                              <td>
                                  <button type="button" class="btn btn-s btn-white" modal-right="400"  ng-click="addDataItemClick()"><i
                                          class="iconfont icon-add"></i> 添加
                                  </button>

                                  <button type="button" class="btn btn-s btn-orange"  modal-scope="this" modal-url="views/list-view.html"><i class="iconfont icon-delete"></i> 导入</button>
                              </td>
                          </tr>
                          </tbody>
                      </table>
                  </div>

                      <!-- 添加订单-->
              <div class="form-tr">
                  <div class="form-th"></div>
                  <div class="form-td">
                      <button type="button" class="btn btn-l"  ng-click="submitForm('addSalesOrderForm','save')">保存草稿</button>
                        <button type="button" class="btn btn-l" ng-click="submitForm('addSalesOrderForm','submit')">生成订单</button>
                          <button type="button" class="btn btn-l" ng-click="cancelForm()">取消返回</button>
                  </div>
              </div>
          </form>
      </div>
</div>

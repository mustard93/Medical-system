<div ng-controller="pageCtrl"
     class="pd-c-xxxl left-se-side-par "
     ajax-url="rest/authen/warehouse/getByCodeAndOrganizationId?code={{listParams.warehouseStocksCode}}" style="min-height:600px;"><!-- pageCtrl-->
    <div ng-controller="MedicalStockController" class="page-main-content left-se-side-par">

        <!--body wrapper start-->
        <div class="pd-c-xxl">
           <div class="page-header-info ">
             <p class="mgb bb-line pdb-s relative  ">
               <a href="#/medicalStock/query-stock.html">
                 <span class="circle ">
                      <span class="pr-arrow-l"></span>
                 </span>
               </a>
               <em class="mgl-xxl">库存报表 </em>/ <em class="color-custom-orange">库存查询</em> / <em >库存变动明细</em>
             </p>

             <p ajax-url="rest/authen/warehouse/getByCodeAndOrganizationId?code={{urlInfo.search.warehouseCode}}" scope-data="warehouseName">
               <em>仓库：</em>
               <em ng-if="warehouseName.name">{{warehouseName.name}}</em>
               <em ng-if="!warehouseName.name">全部</em>
             </p>

           </div>

           <!-- 主体内容 start-->
           <table-list list-data="rest/authen/medicalStock/queryInoutstockDetailChange?medicalStockId={{mainStatus.pageParams.medicalStockId}}"
                       list-params="listParams"
                       search-mode="noCaseSensitive"
                       search-param="q">
          <h1 class="color-black text-l pd">{{tbodyList[0].name}}</h1>
          <div class="content-wrapper-main mgt">
              <div class="pd-c">
                           <!-- 搜索框 start-->
                           <div class="text-left order-list-search relative" ng-init="queryDatePeriod=''">
                               <select class="pr-select select-wd mgr-l" ng-model="queryDatePeriod"
                                date-period-select start-time="listParams.createAtBeg" end-time="listParams.createAtEnd">
                                 <option value="最近7天">最近7天</option>
                                 <option  value="最近10天">最近10天</option>
                                 <option  value="最近一个月">最近一个月</option>
                               </select>

                                 <input type="text"
                                        datepicker
                                        class="ipt pr-short-ipt color-6 mgr"
                                        ng-readonly="true"
                                        placeholder="日期"
                                        ng-model="listParams.createAtBeg">
                                  <span class="mgr">至</span>
                                  <input type="text"
                                        datepicker
                                        class="ipt pr-short-ipt color-6 mgr-l"
                                        ng-readonly="true"
                                        placeholder="日期"
                                        ng-model="listParams.createAtEnd">
                           <input type="text" class="ipt pdr-xxl" placeholder="单据编号/经手人" ng-model="listParams.q">
                             <i class="ipt-i"></i>
                           </div>
                            <!-- 搜索框 end-->

                 <!-- 主内容头部 -->
                 <div class="content-wrapper-heading h-l mgb-m mgt-m pdb-s mgr relative">
                   <!-- 主内容区域 -->
                   <div class="content-wrapper-main">
                       <div class="pd-c">
                         <table  class="table table-hover table-striped table-mr table-bordered table-content">
                           <thead class="pr-bg-side">
                             <tr>
                               <th>序号</th>
                               <th>单据日期</th>
                               <th>单据类型</th>
                               <th>单据编号</th>
                               <th>仓库</th>
                               <th>单位</th>
                               <th>经手人</th>
                               <th>入库数量</th>
                               <th>出库数量</th>
                               <th>库存余量</th>
                               <th>成本价</th>
                               <th>成本金额</th>
                             </tr>
                           </thead>
                           <tbody class="pr-bg-white">
                             <tr ng-repeat="tr in tbodyList track by $index">
                               <td>{{$index + 1}}</td>
                               <td>{{tr.createAt | date:'yyyy-MM-dd'}}</td>
                               <td class="text-ellips-s">{{tr.type}}</td>
                               <td>{{tr.orderNo}}</td>
                               <td>{{tr.warehouseName}}</td>
                               <td>{{tr.unit}}</td>
                               <td>{{!tr.inputUser.n?'&nbsp;':tr.inputUser.n}}</td>
                               <td >{{tr.changeQuantity>0?tr.changeQuantity:'0'}}</td>
                               <td >{{tr.changeQuantity<0?Math.abs(tr.changeQuantity):'0'}}</td>
                               <td>{{tr.quantity}}</td>
                               <td>{{tr.price?tr.price:'0'}}</td>
                               <td>{{$root.utils.numberMul(tr.quantity,tr.price)}}</td>
                             </tr>

                             <tr class="bgco-orange color-white" ng-if="tbodyList.length>0"
                               ng-init="totalObj=$root.utils.sumTotalByArray(tbodyList,['price','quantity','changeQuantity'])">
                               <td colspan="7" class="text-right">合计：</td>
                               <td>{{totalObj.changeQuantity>0?totalObj.changeQuantity:'&nbsp;'}}</td>
                               <td>{{totalObj.changeQuantity<0?totalObj.changeQuantity:'&nbsp;'}}</td>
                               <td>{{totalObj.quantity}}</td>
                               <td>{{totalObj.price}}</td>
                               <td>&nbsp;</td>
                             </tr>
                           </tbody>
                         </table>
                         <!-- 分页 -->
                         <div class="clearfix">
                             <div class="fr">
                                 <pagination status="status"></pagination>
                             </div>
                         </div>
                       </div>
                   </div>
                   <!-- 主体内容 end -->
                 </div>
               </div>
          <!--body wrapper end-->
          </div>
        </table-list>
      </div>
    </div>
  </div>

<div class="content-wrapper"
     ajax-url="rest/authen/salesOrder/previewConfirmSalesOrder.json?id={{mainStatus.pageParams.id}}"
     scope-data="showData"
     callback="formData={};formData.id=showData.salesOrder.id"
     alert-error>

  <!-- 主内容头部 -->
  <div class="content-wrapper-heading mgt-m mgb-m">
    <h1 class="pr-title-color pr-font-24">订单</h1>
  </div>
  <!-- 主内容区域 -->

  <form name="createOrderForm"
        action="rest/authen/salesOrder/confirmSalesOrder"
        form-validator
        alert-error
        callback="goTo('#/salesOrder/order-done.html?id='+formData.id)">

  <div class="content-wrapper-main pr-bg-white pr-border pr-fuzzy-boundary">


    <div class="pd-c-xxxxl bb-line">
      <div class="mg-xl text-s color-9">
        <p class="mgb-l">
          <span>订单编号：</span><span class="pr-color color-6">{{showData.confirmOrder.orderNo}}</span>
          <span>创建时间：</span><span class="pr-color color-6"></span>
          <span>对应购需单：</span><span class="pr-color color-6">{{showData.salesOrder.orderNo}}</span>
          <span>订单状态：</span><span class="pr-color color-6">{{showData.confirmOrder.orderStatus}}</span>

        </p>

      </div>
    </div>

    <!-- 用户信息 -->
    <div class="pd-c-xxxxl bb-line">
      <div class="mg-xl text-s color-9">

        <p class="mgb-l">
          <span>客户名：</span><span class="color-6">{{showData.salesOrder.customerName}}</span>
          <span>负责人：</span><span class="color-6 mgr-xl">{{showData.salesOrder.saleUser.n}} </span>
      <span>期望到货时间：</span><span class="color-6 mgr-xl">{{showData.salesOrder.expectDate| date : 'yyyy-MM-dd'}}</span>
        </p>
        <p class="mgb-l">
          <span>收货人信息：</span><span class="color-6">{{showData.salesOrder.address.name}} {{showData.salesOrder.address.address}} {{showData.salesOrder.address.tel}}</span></p>

      </div>
    </div>
    <!-- 商品列表 -->
    <div class="pd-c-xxxxl" ng-init="orderMedicalNoIds=[]">
      <!-- 可发货 -->
      <div class="confirm-order bb-line pdb-l" >
        <h1 class="pdt-l color-6 text-m text-bold" >订购清单</h1>
        <table class="mgt-l pr-table" style="width:100%;table-layout:auto;">
          <thead>
              <th class="w-70 text-center">货品编码/货位</th>
            <th class="pr-indent-20">药械名称/生产厂家/规格</th>
              <th class="w-70 text-center">剂型</th>
            <th class="w-70 text-center">单位</th>
              <th class="w-120 text-center">数量</th>
            <!-- <th class="w-70 text-center">同批次</th> -->
            <th class="w-186 text-center">批次号</th>
            <!-- <th class="w-90 text-center">库存</th> -->
              <th class="w-80 text-center">生产日期</th>
                  <th class="w-80 text-center">有效期</th>
            <th class="w-80 text-center">批准文号</th>
                <th class="w-80 text-center">药械属性</th>
          </thead>

          <tbody>
            <tr class="tr-interval"><td colspan="9"></td></tr>
            <tr ng-repeat="tr in showData.confirmOrder.orderMedicalNos"  ng-init="orderMedicalNoIds.push(tr.relId)">

                  <td class="has-border text-center text-v-t pd-m"></td><!-- 货品编码/货位-->
              <td class="goods-name has-border pd-m">
                <div class="pr-table-td-m relative">
                  <span class="goods-thumbnail inline-block"><img ng-src="{{tr.headUrl}}" alt=""></span>
                  <span class="block">
                    <p class="pdl-l mgb-s color-6 text-n text-bold"><span>{{tr.name}}</span></p>
                    <p class="pdl-l mgb-s color-9 text-s"><span>{{tr.manufacturer}}</span></p>
                    <p class="mgt-s color-9 text-s"><span class="mgl-l">{{tr.specification||"无规格"}}</span></p>
                  </span>
                </div>
              </td>
              <td class="has-border text-center text-v-t pd-m"></td><!--剂型-->
              <td class="has-border text-center text-v-t pd-m">{{tr.unit}}</td>
                  <td class="has-border text-center text-v-t pd-m">{{tr.quantity}}</td>
              <!-- <td class="has-border text-center text-v-t pd-m">{{tr.isSameBatch}}</td> -->
              <td class="has-border text-center text-v-t pd-m">{{tr.batchNo}}</td>
              <!-- <td class="has-border text-center text-v-t pd-m">{{medicalStockMap[tr.relId].quantity}}</td> -->
                  <td class="has-border text-center text-v-t pd-m">暂无</td><!-- 生产日期-->
                <td class="has-border text-center text-v-t pd-m">暂无</td><!-- 有效期-->
                    <td class="has-border text-center text-v-t pd-m">暂无</td><!-- 批准文号-->
                    <td class="has-border text-center text-v-t pd-m">普通</td><!-- 药械属性-->

            </tr>

          </tbody>
        </table>
        <div>

          <p>

            <span>备注：</span><span class="color-6">{{showData.salesOrder.note}}</span>
          </p>
          
            <!-- 总价 -->
            <div class="text-right pd-c-xxxxl pdb-xxl pdt-xxl">
              <span class="pr-font-24 color-9">总价：</span>
              <span class="pr-font-24 color-6">￥{{showData.confirmOrder.totalPrice|number :2}}</span>
            </div>
            <!-- 提交按钮 -->
            <div class="pd-c-xxxxl pdb-xxl text-right">
              <span class="mgr-l"><button class="pr-btn-create-glodbg" type="submit" >确认订单&提交审批</button></span>
            </div>

        </div>
    <!-- 不可发货 -->


        <h1 class="pdt-l color-6 text-m text-bold" >暂不可转入订单部分</h1>
        <table class="mgt-l pr-table" style="width:100%;table-layout:auto;">
          <thead>
              <th class="w-70 text-center">货品编码/货位</th>
            <th class="pr-indent-20">药械名称/生产厂家/规格</th>
              <th class="w-70 text-center">剂型</th>
            <th class="w-70 text-center">单位</th>
              <th class="w-120 text-center">数量</th>
            <!-- <th class="w-70 text-center">同批次</th> -->
            <th class="w-186 text-center">批次号</th>
            <!-- <th class="w-90 text-center">库存</th> -->
              <th class="w-80 text-center">生产日期</th>
                  <th class="w-80 text-center">有效期</th>
            <th class="w-80 text-center">批准文号</th>
                <th class="w-80 text-center">药械属性</th>
          </thead>

          <tbody>
            <tr class="tr-interval"><td colspan="9"></td></tr>
            <tr ng-repeat="tr in showData.confirmOrder.orderMedicalNos"  ng-init="orderMedicalNoIds.push(tr.relId)">

                  <td class="has-border text-center text-v-t pd-m"></td><!-- 货品编码/货位-->
              <td class="goods-name has-border pd-m">
                <div class="pr-table-td-m relative">
                  <span class="goods-thumbnail inline-block"><img ng-src="{{tr.headUrl}}" alt=""></span>
                  <span class="block">
                    <p class="pdl-l mgb-s color-6 text-n text-bold"><span>{{tr.name}}</span></p>
                    <p class="pdl-l mgb-s color-9 text-s"><span>{{tr.manufacturer}}</span></p>
                    <p class="mgt-s color-9 text-s"><span class="mgl-l">{{tr.specification||"无规格"}}</span></p>
                  </span>
                </div>
              </td>
              <td class="has-border text-center text-v-t pd-m"></td><!--剂型-->
              <td class="has-border text-center text-v-t pd-m">{{tr.unit}}</td>
                  <td class="has-border text-center text-v-t pd-m">{{tr.quantity}}</td>
              <!-- <td class="has-border text-center text-v-t pd-m">{{tr.isSameBatch}}</td> -->
              <td class="has-border text-center text-v-t pd-m">{{tr.batchNo}}</td>
              <!-- <td class="has-border text-center text-v-t pd-m">{{medicalStockMap[tr.relId].quantity}}</td> -->
                  <td class="has-border text-center text-v-t pd-m">暂无</td><!-- 生产日期-->
                <td class="has-border text-center text-v-t pd-m">暂无</td><!-- 有效期-->
                    <td class="has-border text-center text-v-t pd-m">暂无</td><!-- 批准文号-->
                    <td class="has-border text-center text-v-t pd-m">普通</td><!-- 药械属性-->

            </tr>

          </tbody>
        </table>
        <div class="text-right pd-c-xxxxl pdb-xxl pdt-xxl">
          <span class="pr-font-24 color-custom-orange">请等待库存补足后，即可另外生成销售订单。可在购需单{{showData.salesOrder.orderNo}}跟踪此部分最新状态。</span>

        </div>

            <!-- 不可发货 -->
      </div>

      <!-- 对应采购单 -->
      <!-- <div class="confirm-order bb-line pdb-l">
        <h1 class="pdt-l color-6 text-m text-bold">需采购药械</h1>
        <table class="mgt-l pr-table" style="width:100%;table-layout:auto;">
          <thead>
            <th class="pr-indent-20">药械名称/生产厂家/规格</th>
            <th class="w-106 text-center">单位</th>
            <th class="w-106 text-center">同批次</th>
            <th class="w-186 text-center">批次号</th>
            <th class="w-106 text-center">库存</th>
            <th class="w-150 text-center">采购数量</th>
          </thead>
          <tbody>

            <tr class="tr-interval"><td colspan="9"></td></tr>
            <tr ng-repeat="tr in showData.purchaseOrder.orderMedicalNos"  ng-init="orderMedicalNoIds.push(tr.relId)">
              <td class="goods-name has-border pd-m">
                <div class="relative">
                  <span class="goods-thumbnail inline-block"><img ng-src="{{tr.headUrl}}" alt=""></span>
                  <span class="inline-block">
                    <p class="pdl-l mgb color-6 text-n text-bold"><span>{{tr.name}}</span></p>
                    <p class="pdl-l mgb color-9 text-n"><span>{{tr.manufacturer}}</span></p>
                    <p class="mgt-s color-9 text-n"><span class="mgl-l">{{tr.specification||"无规格"}}</span></p>

                  </span>
                </div>
              </td>

              <td class="has-border text-center">{{tr.unit}}</td>
              <td class="has-border text-center">{{tr.isSameBatch}}</td>
              <td class="has-border text-center">{{tr.batchNo}}</td>
              <td class="has-border text-center">{{medicalStockMap[tr.relId].quantity}}</td>
              <td class="has-border pr-bg-pink text-center">{{tr.quantity}}</td>

            </tr>

          </tbody>
        </table>
      </div>
    </div> -->

    <!-- 提交按钮 -->
    <div class="pd-c-xxxxl pdb-xxl text-right">
      <span><a href="javascript:;" ng-click="goTo('#/salesOrder/edit.html?id='+formData.id)">返回修改</a></span>
    </div>
  </div>
  </form>


          <!-- 加载选中药械库存-->
          <!-- <div   ajax-if="orderMedicalNoIds"
          ajax-url="rest/authen/medicalStock/countStockByIds.json?ids={{orderMedicalNoIds.join(',')}}" scope-data="medicalStockMap" alert-error>
        </div> -->
</div>

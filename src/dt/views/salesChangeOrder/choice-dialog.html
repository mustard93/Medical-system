
<div class="modal-content pr-modal-content right-side-new pr-bg-black4 more-stock"
     ng-controller="returnOrderChoiceDialogCtrl"
     ajax-url=""
     scope-data="stockBatchList"
     ng-init="listParams={};angucomplete_data={};curOrder=null;"
     style="position: relative"
     callback="initFlag=true;$root.reloadTime=$root.utils.getNowTime();getChoisedBatchsId(dialogData.choisedBatchList);"
>

    <style>

        .tab a {
            display: block;
            width: 150px;
            float: left;
            height: 100%;
            margin: 0;
            padding: 0;
            border-bottom: #C7A77B solid 1px;
            border-right: #C7A77B solid 1px;
            margin-top: -1px;
        }

        .tab a.cur {
            color: white;
            background: #443F3A;
            border-bottom: #443F3A solid 1px;
        }

        .goods-info {
            margin: 15px 20px;
        }

        .goods-info .color-6 {
            font-size: 12px;
            color: #999999;
            line-height: 16px;
            width: 40%;
            display: inline-block;

        }

        .goods-info .color-6 i {
            color: white;
            font-style: normal;

        }

        .line-dotted {
            height: 2px;
            margin: 10px 0;
            width: auto;
            border-bottom: dashed rgba(255, 255, 255, 0.26) 1px;
        }

        .order-list {
            width: 100%;
            margin: 15px;
            height: 570px;
            overflow: auto;
            padding-bottom: 50px;
        }

        .order-list ul.li-min-h li {
            width: 33%;
            float: left;
            cursor: pointer;
            padding-top: 5px;
        }

        .order-list li .mgb-xxl:hover,.order-list li .mgb-xxl.on {
            -webkit-box-shadow: 0 0 10px #ff8c00;
            -moz-box-shadow: 0 0 10px #ff8c00;
            box-shadow: 0 0 10px #ff8c00;
        }

        .order-list li .pr-bg-grey2 {
            background: #ddd;
        }


        .choiced {
            width: 25px;
            height: 25px;
            /*line-height: 25px;*/
            /*background: #C7A77B;*/
            /*color: #fff;*/
            /*border-radius: 50%;*/
            /*text-align: center;*/
            /*font-size: 20px;*/
            position: absolute;
            left: 10px;
        }


        /* 重写样式- 药械闪加*/
        p.mgb{
            display: none;
        }
       input.pr-w-100{
            width: 390px!important;
        }
        .angucomplete-dropdown{
            width: 390px!important;
        }
        .angucomplete-holder .ipt{
            width: 100%;
        }

    </style>

    <!-- 标题 -->
    <div class="bb-line-gold pr-bg-black2 min-h-l">
        <h1 ng-init="type='按商品查找'" class="pr-indent-20 pdb-m text-n" style="line-height:50px;max-height:35px;">
            参照发货单
        </h1>
    </div>


    <div
         ajax-url="rest/authen/lendOrder/getByOrderCode?orderCode={{selectedData.data.orderCode}}"
         scope-data="scopeData"
         callback="isChoiseAll=false;checkRelId(dialogData.relId,scopeData.id); selectedBatchs= initChoisedMedicalList(formData.orderMedicalNos, scopeData.orderMedicalNos,'id');">
        <!-- 过滤条件 -->
        <div class="pdt-s pdb-s pd-c-xl">

            <!--  -->
            <div class="inline-block" style="margin: 20px 0 20px -10px;">

                <span angucomplete placeholder="发货单号"
                      style="width: 390px"
                      title-field="orderCode"
                      search-str-class="ipt ipt-bg-black"
                      url="rest/authen/lendOrder/queryAutoComplete?tableName=Order.LendOrder&property=orderCode"
                      class="inline-block"
                      ng-model="selectedData">
                </span>


            </div>
        </div>

        <!--客戶和物流信息-->
        <div class="">

            <div class="pr-bg-black4">
                <div class="mgb">

                    <div class="inline-block br-line customer-name relative mgl-l" style="width:214px;background: rgba(47,42,38,4.2);">
                        <p class="mgb-s mgl-xl color-white">客户名</p>
                        <p class="text-n color-black mgl-xl autocut-default color-white" title="{{addDataObj.customerName}}" style="width:100px;">
                            {{addDataObj.customerName}}
                        </p>
                    </div>

                    <div class="inline-block logistics-center relative mgl-l" style="width:214px;background: rgba(47,42,38,4.2);">
                        <p class="mgb-s mgl-xl color-white">物流中心</p>
                        <p class="text-n color-black mgl-xl autocut-default color-white" title="{{addDataObj.logisticsCenterName}}" style="padding-right:182px; width:100px;">
                            {{addDataObj.logisticsCenterName || '暂无'}}
                        </p>
                    </div>

                </div>

            </div>

            <div class="panel pr-panel pr-fuzzy-boundary pr-panel-height mgb-l pd-n" style="background: #787470;padding: 0;">
                <!-- 单据信息 -->
                <div class="flex-column color-9 pd-c-l pdt-m pdb-m bb-dashed-line">
                    <div class="flex-item-6">
                        <span class="mgr">单据编号：<em class="color-3">{{scopeData.orderCode}}</em></span>
                        <span class="mgr">单据日期：<em class="color-3">{{scopeData.orderDate || '暂无' | date:'yyyy-MM-dd'}}</em></span>
                    </div>
                    <div class="flex-item-6 text-right">
                       <span class="mgr">状态：<em class="color-3">{{scopeData.orderStatus}}</em></span>
                    </div>
                </div>

                <!-- 类别选择 -->
                <div class="pd-c-l pdt-m pdb-m color-9">
                    <span class="mgr-l">业务部门：<em class="color-3">{{scopeData.salesDepartmentName}}</em></span>
                    <span class="mgr-l">业务人员：<em class="color-3">{{scopeData.saleUser.n}}</em></span>
                    <span class="mgr-l">销售类型：<em class="color-3">{{scopeData.salesType}}</em></span>
                    <!--<span class="mgr-l">付款条件：<em class="color-3">{{scopeData.paymentType}}</em></span>-->
                    <!--<span class="mgr-l">币种：<em class="color-3">{{scopeData.currencyType}}</em></span>-->
                    <!--<span class="mgr-l">汇率：<em class="color-3">1.00</em></span>-->
                    <span class="mgr-l">预发货日期：<em class="color-3">{{scopeData.expectDate | date:'yyyy-MM-dd'}}</em></span>
                </div>
                <!-- 商品列表 -->
                <div class="">
                    <table class="table pr-table pr-new-table mgb-n">
                            <thead>
                            <tr>
                                <th class="w-60 text-center mycheck">
                                    <input type="checkbox" class="selectAll cur-pot" id='1'

                                           ng-model="isChoiseAll2"
                                           ng-click="handleChoiseAllEvent(isChoiseAll2,scopeData.orderMedicalNos);"
                                    >
                                    <label for="1" style="top: 10px;"></label>
                                </th>
                                <th class="text-center">商品编号</th>
                                <th>商品通用名</th>
                                <th class="text-center">剂型/分类</th>
                                <th class="text-center">规格/型号</th>
                                <th class="text-center">单位</th>
                                <th class="text-center">计划数量</th>
                                <th class="text-center">实发数量</th>
                                <th class="text-center">生产批号</th>
                                <th class="text-center">灭菌批号</th>
                                <th class="text-center">仓库</th>
                                <th class="text-center">含税单价</th>
                                <th class="text-center">价税合计</th>
                                <th class="text-center">失效日期</th>

                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="item in scopeData.orderMedicalNos">

                                <td class="select-td text-center mycheck">

                                    <!--ng-disabled="itemInArray(tr.onlyId,formData.orderMedicalNos,'onlyId') || tr.returnTotal<1"-->

                                    <input type="checkbox"
                                           ng-init="item.handleFlag= compareOrderId(dialogData.relId,scopeData.id) && itemInArray(item.id,formData.orderMedicalNos,'id');
                                       item.disabled=  (itemInArray(item.id,formData.orderMedicalNos,'id')   || (item.actualCount - item.cumulativeReturnCount)<1);"
                                           ng-disabled="!compareOrderId(dialogData.relId,scopeData.id) || item.disabled"
                                           class="selectOne cur-pot" id='{{$index+2}}'
                                           ng-model="item.handleFlag"
                                           ng-click="handleItemClickEvent(item,scopeData.orderMedicalNos,'id');">
                                    <label for="{{$index+2}}"></label>


                                </td>

                                <td class="text-center">{{item.code}}</td>
                                <td>
                                    <span
                                            class="color-orange cur-pot lend-order-goods-info"
                                            ng-init="showInfoArea=false"
                                            ng-mouseenter="showInfoArea=true"
                                            ng-mouseleave="showInfoArea=false">{{item.approvedName}}
                                      <show-info-modal ng-show="showInfoArea"
                                                       get-data-type="local"
                                                       template-url="tpl/showInfoModalLendOrder"
                                                       info-object="{{item}}"
                                                       info-title="商品信息">
                                      </show-info-modal>
                                    </span>
                                </td>
                                <td class="text-left">{{item.dosageForms}}</td><!-- 剂型分类 -->
                                <td class="text-center">{{item.specificationAndModelType}}</td>
                                <td class="text-center">{{item.unit}}</td>
                                <td class="text-center">{{item.quantity}}</td>
                                <td class="text-center">{{item.outgoingQuantity}}</td>
                                <!-- <td class="text-center">{{item.differenceQuantity}}</td> -->
                                <!-- 批号要求 -->
                                <td class="text-center">{{item.productionBatch}}</td>
                                <td class="text-center">{{item.sterilizationBatchNumber}}</td>
                                <td class="text-center">{{item.warehouseName}}</td>
                                <td class="text-right">￥{{item.strike_price | number:2}}</td>
                                <td class="text-right">￥{{item.strike_price*item.quantity || item.totalPrice | number:2}}</td>
                                <td class="text-center">{{item.validTill | date : 'yyyy-MM-dd'}}</td>
                            </tr>
                            </tbody>
                        </table>

                    <div ng-if="!scopeData" class="empty-table clearfix" style="background: #6e6a67;">
                        <div>&nbsp;</div>
                        <div>&nbsp;</div>
                        <div>&nbsp;</div>
                    </div>
                </div>
            </div>


            <div class="footer-button-area" style="position:fixed;bottom:0px;">
                <button type="submit" style="margin-left:500px;" ng-disabled="selectedBatchs2.length<1"
                        class="pr-btn-create-glodbg new-left-side-button"
                        ng-click="addOrderDataToList(dialogData.relId,scopeData.id,scopeData.orderNo,scopeData.orderCode);modal.close()">确定</button>
            </div>
        </div>

    </div>

</div>


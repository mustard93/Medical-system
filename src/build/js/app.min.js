!function(){var e=document.getElementById("requirejs_baseUrlId");if(!e){var t=document.getElementsByTagName("srcript");e=t[t.length-1]}require.dir=e.src.match(/[^?#]*\//)[0],Config.tplPath||(Config.tplPath="")}(),require.config({waitSeconds:0,baseUrl:require.dir+"modules",paths:{jQuery:"../libs/jquery.min",underscore:"../libs/underscore/underscore-1.5.2.min",moment:"../libs/moment.min",echarts:"../libs/echarts/echarts-3.2.3.min",chosen:"../libs/chosen.jquery.min",angular:"../libs/angular",ngRoute:"../libs/angular-route",autocomplete:"../libs/jquery.autocomplete.min",bootstrap:"../libs/bootstrap.min","jquery-ui":"../libs/jquery-ui.min",nicescroll:"../libs/jquery-nicescroll.min",easypiechart:"../libs/easypiechart/angular.easypiechart",icheck:"../libs/jquery.icheck.min",clndr:"../libs/calendar/clndr.min"},shim:{jQuery:{exports:"jQuery"},underscore:{exports:"_"},chosen:{deps:["jQuery"]},echarts:{exports:"echarts"},angular:{deps:["jQuery"],exports:"angular"},ngRoute:{deps:["angular"],exports:"ngRoute"},autocomplete:{deps:["jQuery"],exports:"autocomplete"},bootstrap:{deps:["jQuery"],exports:"bootstrap"},"jquery-ui":{deps:["jQuery"],exports:"jquery-ui"},nicescroll:{deps:["jQuery"],exports:"nicescroll"},easypiechart:{deps:["jQuery"],exports:"easypiechart"},icheck:{deps:["jQuery"],exports:"icheck"},clndr:{deps:["jQuery"],exports:"clndr"}},urlArgs:""}),require(["bootstrap","jquery-ui","nicescroll","easypiechart","icheck"],function(){}),define("manageApp.template",["angular"],function(){angular.module("manageApp.template",[])}),define("manageApp.main",["main/init","main/services","main/controllers","main/directives","main/filters"]),define("manageApp.project",["project/init","project/services","project/controllers","project/directives","project/filters"]),define("manageApp.modal",["modal/init","modal/services","modal/directives"]),define("manageApp.upload",["upload/init","upload/directives"]),define("datePicker",["datepicker/datepicker"]),define("manageApp",["angular","manageApp.template","manageApp.modal","manageApp.main","manageApp.project","manageApp.upload","datePicker"],function(){return angular.module("manageApp",["ngRoute","manageApp.template","manageApp.modal","manageApp.main","manageApp.project","manageApp.upload","datePicker","easypiechart"])}),require(["manageApp","ngRoute"],function(e){e.config(["$routeProvider","$templateRequestProvider",function(e,t){window.Config?e.when("/:page*",{templateUrl:function(e){var t=(Config.viewsDir||"")+e.page;delete e.page;var a=$.param(e);return a?t+"?"+a:t},resolve:{load:function(){}}}).otherwise({redirectTo:Config.indexPage}):e.when("/:page*",{templateUrl:function(e){var t=e.page;delete e.page;var a=$.param(e);return a?t+"?"+a:t},resolve:{load:function(){}}}),t.httpOptions({headers:{template:"1"}})}]),angular.bootstrap(document,["manageApp"])}),define("datepicker/datepicker",["moment","angular"],function(e){e.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"日_一_二_三_四_五_六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm分",LTS:"Ah点m分s秒",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日Ah点mm分",LLLL:"YYYY年MMMD日ddddAh点mm分",l:"YYYY-MM-DD",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日Ah点mm分",llll:"YYYY年MMMD日ddddAh点mm分"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"下午"===t||"晚上"===t?e+12:e>=11?e:e+12},meridiem:function(e,t,a){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1130?"上午":n<1230?"中午":n<1800?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var t,a;return t=e().startOf("week"),a=this.unix()-t.unix()>=604800?"[下]":"[本]",0===this.minutes()?a+"dddAh点整":a+"dddAh点mm"},lastWeek:function(){var t,a;return t=e().startOf("week"),a=this.unix()<t.unix()?"[上]":"[本]",0===this.minutes()?a+"dddAh点整":a+"dddAh点mm"},sameElse:"LL"},ordinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}});var t=angular.module("datePicker",[]);t.constant("datePickerConfig",{template:Config.tplPath+"tpl/datepicker.html",view:"month",views:["year","month","date","hours","minutes"],momentNames:{year:"year",month:"month",date:"day",hours:"hours",minutes:"minutes"},viewConfig:{year:["years","isSameYear"],month:["months","isSameMonth"],hours:["hours","isSameHour"],minutes:["minutes","isSameMinutes"]},step:5}),t.filter("mFormat",function(){return function(t,a,n){return e.isMoment(t)?n?e.tz(t,n).format(a):t.format(a):e(t).format(a)}}),t.directive("datePicker",["datePickerConfig","datePickerUtils",function(t,a){return{require:"?ngModel",template:'<div ng-include="template"></div>',scope:{model:"=datePicker",after:"=?",before:"=?",dateSelect:"=?",dateMonth:"=?",statusList:"=?"},link:function(n,i,r,o){function l(){n.views=t.views.concat(),n.view=r.view||t.view,n.views=n.views.slice(n.views.indexOf(r.maxView||"year"),n.views.indexOf(r.minView||"minutes")+1),1!==n.views.length&&n.views.indexOf(n.view)!==-1||(n.view=n.views[0])}function s(e){return a.getDate(n,r,e)}function c(e){e&&(n.model=e,o&&o.$setViewValue(e.format(r.format))),n.$emit("setDate",n.model,n.view),n.callbackOnSetDate&&n.callbackOnSetDate(r.datePicker,n.date)}function u(){var e=n.view;a.setParams(y),n.model&&!v&&(n.date=$(n.model),v=!1);var t=n.date;switch(e){case"year":n.years=a.getVisibleYears(t);break;case"month":n.months=a.getVisibleMonths(t);break;case"date":n.weekdays=n.weekdays||a.getDaysOfWeek(),n.weeks=a.getVisibleWeeks(t);break;case"hours":n.hours=a.getVisibleHours(t);break;case"minutes":n.minutes=a.getVisibleMinutes(t,C)}p()}function d(){return"date"!==n.view?n.view:n.date?n.date.month():null}function p(){var e,i,r=n.view,o=n.date,l=[],s="";if(a.setParams(y),"date"===r){var c,u=n.weeks;for(e=0;e<u.length;e++)for(c=u[e],l.push([]),i=0;i<c.length;i++)s="",a.isSameDay(o,c[i])&&(s+="active"),h(c[i],r)&&(s+=" now"),c[i].month()===o.month()&&f(c[i])||(s+=" disabled"),l[e].push(s)}else{var d=t.viewConfig[r],p=n[d[0]],g=d[1];for(e=0;e<p.length;e++)s="",a[g](o,p[e])&&(s+="active"),h(p[e],r)&&(s+=" now"),f(p[e])||(s+=" disabled"),l.push(s)}n.classes=l}function f(e){var t=!0;return w&&w.isAfter(e)&&(t=g(w,e)),D&&D.isBefore(e)&&(t&=g(D,e)),t}function g(e,a){return!!e.isSame(a,t.momentNames[n.view])}function m(e){return w&&w.isAfter(e)?w:D&&D.isBefore(e)?D:e}function h(e,t){var a=!0;switch(t){case"minutes":a&=~~(S.minutes()/C)===~~(e.minutes()/C);case"hours":a&=S.hours()===e.hours();case"date":a&=S.date()===e.date();case"month":a&=S.month()===e.month();case"year":a&=S.year()===e.year()}return a}a.setParams(r.timezone);var v=!1,y=n.tz=r.timezone,$=a.createMoment,b=a.eventIsForPicker,C=parseInt(r.step||t.step,10),k=!!r.partial,w=s("minDate"),D=s("maxDate"),x=i[0].id,S=n.now=$(),A=n.date=$(n.model||S),P="true"===r.autoClose;n.model||A.minute(Math.ceil(A.minute()/C)*C).second(0),n.template=r.template||t.template,n.watchDirectChanges=void 0!==r.watchDirectChanges,n.callbackOnSetDate=r.dateChange?a.findFunction(n,r.dateChange):void 0,l(),n.setView=function(e){n.views.indexOf(e)!==-1&&(n.view=e)},n.selectDate=function(e){if(r.disabled)return!1;if(g(n.date,e)&&(e=n.date),"date"==n.view&&n.dateSelect&&n.dateSelect(e),e=m(e),!e)return!1;n.date=e;var t=n.views[n.views.indexOf(n.view)+1];(!t||k||n.model)&&c(e),t?n.setView(t):P?(i.addClass("hidden"),n.$emit("hidePicker")):p()},n.$watch(d,u),n.watchDirectChanges&&n.$watch("model",function(){v=!1,u()}),n.next=function(t){var a=e(n.date);switch(t=t||1,n.view){case"year":case"month":a.year(a.year()+t);break;case"date":a.month(a.month()+t),n.dateMonth&&n.dateMonth(a);break;case"hours":case"minutes":a.hours(a.hours()+t)}a=m(a),a&&(n.date=a,c(a),v=!0,u())},n.prev=function(e){return n.next(-e||-1)},x&&n.$on("pickerUpdate",function(e,t,a){if(b(t,x)){var n=!1,i=!1;angular.isDefined(a.minDate)&&(w=!!a.minDate&&a.minDate,i=!0),angular.isDefined(a.maxDate)&&(D=!!a.maxDate&&a.maxDate,i=!0),angular.isDefined(a.minView)&&(r.minView=a.minView,n=!0),angular.isDefined(a.maxView)&&(r.maxView=a.maxView,n=!0),r.view=a.view||r.view,n&&l(),i&&u()}})}}}]),angular.module("datePicker").factory("datePickerUtils",function(){var t,a=function(a,n,i,r,o){var l=Date.UTC(0|a,0|n,0|i,0|r,0|o);return t?e.tz(l,t):e(l)};return{getVisibleMinutes:function(e,t){var n,i,r=e.year(),o=e.month(),l=e.date(),s=e.hours(),c=e.utcOffset()/60,u=[];for(i=0;i<60;i+=t)n=a(r,o,l,s-c,i),u.push(n);return u},getVisibleWeeks:function(t){t=e(t);var a=t.year(),n=t.month();t.date(1);var i=t.day();0===i?t.date(-6):t.date(1-i);for(var r=[];r.length<6&&!(t.year()===a&&t.month()>n);)r.push(this.getDaysOfWeek(t)),t.add(7,"d");return r},getVisibleYears:function(t){var n=e(t),i=n.year();n.year(i-i%10),i=n.year();for(var r,o,l=n.utcOffset()/60,s=[],c=0;c<12;c++)r=a(i,0,1,0-l),o=r.utcOffset()/60,o!==l&&(r=a(i,0,1,0-o),l=o),s.push(r),i++;return s},getDaysOfWeek:function(n){n=n?n:t?e.tz(t).day(0):e().day(0);for(var i,r,o=n.year(),l=n.month(),s=n.date(),c=[],u=n.utcOffset()/60,d=0;d<7;d++)i=a(o,l,s,0-u,0,!1),r=i.utcOffset()/60,r!==u&&(i=a(o,l,s,0-r,0,!1)),c.push(i),s++;return c},getVisibleMonths:function(e){for(var t,n,i=e.year(),r=e.utcOffset()/60,o=[],l=0;l<12;l++)t=a(i,l,1,0-r,0,!1),n=t.utcOffset()/60,n!==r&&(t=a(i,l,1,0-n,0,!1)),o.push(t);return o},getVisibleHours:function(e){var t,n,i,r=e.year(),o=e.month(),l=e.date(),s=[],c=e.utcOffset()/60;for(t=0;t<24;t++)n=a(r,o,l,t-c,0,!1),i=n.utcOffset()/60,i!==c&&(n=a(r,o,l,t-i,0,!1)),s.push(n);return s},isAfter:function(e,t){return e&&e.unix()>=t.unix()},isBefore:function(e,t){return e.unix()<=t.unix()},isSameYear:function(e,t){return e&&e.year()===t.year()},isSameMonth:function(e,t){return this.isSameYear(e,t)&&e.month()===t.month()},isSameDay:function(e,t){return this.isSameMonth(e,t)&&e.date()===t.date()},isSameHour:function(e,t){return this.isSameDay(e,t)&&e.hours()===t.hours()},isSameMinutes:function(e,t){return this.isSameHour(e,t)&&e.minutes()===t.minutes()},setParams:function(e){t=e},findFunction:function(e,t){var a=e;do if(a=a.$parent,angular.isFunction(a[t]))return a[t];while(a.$parent);return!1},findParam:function(e,t){var a=e;do if(a=a.$parent,a[t])return a[t];while(a.$parent);return!1},createMoment:function(a){return t?e.tz(a,t):e.isMoment(a)?e.unix(a.unix()):e(a)},getDate:function(e,t,a){var n=!1;return t[a]&&(n=this.createMoment(t[a]),n.isValid()||(n=this.findParam(e,t[a]),n&&(n=this.createMoment(n)))),n},eventIsForPicker:function(e,t){return angular.isArray(e)&&e.indexOf(t)>-1||e===t}}});var t=angular.module("datePicker");t.directive("dateRange",["$compile","datePickerUtils","dateTimeConfig",function(t,a,n){function i(t,a,i,r,o){return n.template(angular.extend(t,{ngModel:i,minDate:!(!r||!e.isMoment(r))&&r.format(),maxDate:!(!o||!e.isMoment(o))&&o.format()}),a)}function r(){return"picker"+Math.random().toString().substr(2)}return{scope:{start:"=",end:"="},link:function(e,n,o){function l(t){e.$broadcast("pickerUpdate",d[0],{maxDate:t})}function s(t){e.$broadcast("pickerUpdate",d[1],{minDate:t})}var c=null,u=n[0].id,d=[r(),r()],p=a.createMoment,f=a.eventIsForPicker;e.dateChange=function(e,t){c&&c(e,t)},u&&e.$on("pickerUpdate",function(t,a,n){f(a,u)&&e.$broadcast("pickerUpdate",d,n)}),a.setParams(o.timezone),e.start=p(e.start),e.end=p(e.end),e.$watchGroup(["start","end"],function(e){s(e[0]),l(e[1])}),angular.isDefined(o.dateChange)&&(c=a.findFunction(e,o.dateChange)),o.onSetDate="dateChange";var g='<div><table class="date-range"><tr><td valign="top">'+i(o,d[0],"start",!1,e.end)+'</td><td valign="top">'+i(o,d[1],"end",e.start,!1)+"</td></tr></table></div>",m=t(g)(e);n.append(m)}}}]);var a="ng-pristine",n="ng-dirty",t=angular.module("datePicker");t.constant("dateTimeConfig",{template:function(e,t){return"<div "+(t?'id="'+t+'" ':"")+'date-picker="'+e.ngModel+'" '+(e.view?'view="'+e.view+'" ':"")+(e.format?'format="'+e.format+'" ':"")+(e.maxView?'max-view="'+e.maxView+'" ':"")+(e.maxDate?'max-date="'+e.maxDate+'" ':"")+(e.autoClose?'auto-close="'+e.autoClose+'" ':"")+(e.template?'template="'+e.template+'" ':"")+(e.minView?'min-view="'+e.minView+'" ':"")+(e.minDate?'min-date="'+e.minDate+'" ':"")+(e.partial?'partial="'+e.partial+'" ':"")+(e.step?'step="'+e.step+'" ':"")+(e.onSetDate?'date-change="'+e.onSetDate+'" ':"")+(e.ngModel?'ng-model="'+e.ngModel+'" ':"")+(e.timezone?'timezone="'+e.timezone+'" ':"")+'class="date-picker-date-time"></div>'},format:"YYYY-MM-DD HH:mm",views:["date","year","month","hours","minutes"],autoClose:!1,position:"relative"}),t.directive("dateTimeAppend",function(){return{link:function(e,t){t.bind("click",function(){t.find("input")[0].focus()})}}}),t.directive("dateTime",["$compile","$document","$filter","dateTimeConfig","$parse","datePickerUtils","$timeout",function(t,i,r,o,l,s,c){var u=i.find("body"),d=r("mFormat");return{require:"ngModel",scope:!0,link:function(i,r,c,p){function f(e){var t=d(e,k,V);return e||(p.$setViewValue(t),r.val(t)),t}function g(e){if(e.length===k.length)return e}function m(t){_=t,c.minDate=t?t.format():t,q=e.isMoment(t)}function h(t){j=t,c.maxDate=t?t.format():t,O=e.isMoment(t)}function v(){C=o.template(c)}function y(e){e.stopPropagation(),p.$pristine&&(p.$dirty=!0,p.$pristine=!1,r.removeClass(a).addClass(n),w&&w.$setDirty(),p.$render())}function $(){P&&(P.remove(),P=null),T&&(T.remove(),T=null)}function b(){if(!P){if(P=t(C)(i),i.$digest(),R||(i.$on("setDate",function(e,t,a){y(e),I&&I(c.ngModel,t),A&&D[D.length-1]===a&&$()}),i.$on("hidePicker",function(){r.triggerHandler("blur")}),i.$on("$destroy",$),R=!0),"absolute"===M){var e=angular.extend(r.offset(),{height:r[0].offsetHeight});P.css({top:e.top+e.height,left:e.left,display:"block",position:M}),u.append(P)}else T=angular.element("<div date-picker-wrapper></div>"),r[0].parentElement.insertBefore(T[0],r[0]),T.append(P),P.css({top:r[0].offsetHeight+"px",display:"block"});P.bind("mousedown",function(e){e.preventDefault()})}}var C,k=c.format||o.format,w=r.inheritedData("$formController"),D=l(c.views)(i)||o.views.concat(),x=c.view||D[0],S=D.indexOf(x),A=c.autoClose?l(c.autoClose)(i):o.autoClose,P=null,L=r[0].id,M=c.position||o.position,T=null,_=null,q=null,j=null,O=null,V=c.timezone||!1,E=s.eventIsForPicker,I=null,R=!1;S===-1&&D.splice(S,1),D.unshift(x),p.$formatters.push(f),p.$parsers.unshift(g),angular.isDefined(c.minDate)&&(m(s.findParam(i,c.minDate)),p.$validators.min=function(t){return!q||e.isMoment(t)&&(_.isSame(t)||_.isBefore(t))}),angular.isDefined(c.maxDate)&&(h(s.findParam(i,c.maxDate)),p.$validators.max=function(t){return!O||e.isMoment(t)&&(j.isSame(t)||j.isAfter(t))}),angular.isDefined(c.dateChange)&&(I=s.findFunction(i,c.dateChange)),L&&i.$on("pickerUpdate",function(e,t,a){if(E(t,L))if(P);else{var n=!1;angular.isDefined(a.minDate)&&(m(a.minDate),n=!0),angular.isDefined(a.maxDate)&&(h(a.maxDate),n=!0),angular.isDefined(a.minView)&&(c.minView=a.minView),angular.isDefined(a.maxView)&&(c.maxView=a.maxView),c.view=a.view||c.view,n&&p.$validate(),angular.isDefined(a.format)&&(k=c.format=a.format||o.format,p.$modelValue=-1),v()}}),r.bind("focus",b),r.bind("blur",$),v()}}}])}),define("main/controllers",["main/init"],function(){function e(e,t){e.mainStatus={navFold:document.body.clientWidth<1500,navigation:"",msgBubble:0},e.curUser={};var a=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()};if(e.currentDate=a(),e.mainConfig=window.Config||{},e.pageTo=function(e){window.location.assign(e)},e.goTo=function(e,t){t?dialogConfirm(t,function(){window.location.assign(e)},null):window.location.assign(e)},e.httpGet=function(a){return Config.serverPath&&0!==a.indexOf("http://")&&0!==a.indexOf("https://")&&(a=e.mainConfig.serverPath+a),t.get(a)},e.logout=function(t){var a="";return Config.logoutUrl?(t||(t="POST"),Config.serverPath&&(a=Config.logoutUrl,0!==a.indexOf("http://")&&0!==a.indexOf("https://")&&(a=e.mainConfig.serverPath+a)),void $.ajax({url:a,type:t,xhrFields:{withCredentials:!0},crossDomain:!0,dataType:"json",success:function(e){window.location.href=Config.loginHtmlUrl}})):void alert("请设置注销接口")},e.hasAuthor=function(t){if(!e.curUser||!e.curUser.additional||!e.curUser.additional.Authoritys)return!1;var a=e.curUser.additional.Authoritys;return $.inArray(t,a)!=-1},e.mainConfig.getMainInfo){var n=e.mainConfig.getMainInfo;Config.serverPath&&(0!==n.indexOf("http://")&&0!==n.indexOf("https://")&&(n=e.mainConfig.serverPath+n),e.mainStatus.requestPath=Config.serverPath),$.ajax({url:n,type:"get",xhrFields:{withCredentials:!0},crossDomain:!0,dataType:"json",success:function(t){200==t.code?(e.curUser=t.data,angular.extend(e.mainStatus,t.data),e.$digest()):802==t.code?window.location.href=Config.loginHtmlUrl:alert(t.msg||"登录失败")}})}$(document).on("click",".top-nav-wrap .backBtn",function(){window.history.back()})}function t(e){}function a(e,t,a,n){t.closeAll(),e.cancelThis=function(e,t){a(e,function(){window.history.go(-1)},t)},e.easypiechart_options={animate:{duration:1e3,enabled:!0},barColor:"#f30",trackColor:"#ffe8ce",scaleColor:!1,lineWidth:8,lineCap:"round",size:125}}function n(e,t){t.closeAll()}angular.module("manageApp.main").controller("mainCtrl",["$scope","$http",e]).controller("sideNav",["$scope",t]).controller("editCtrl",["$scope","modal",n]).controller("pageCtrl",["$scope","modal","dialogConfirm","$timeout",a])}),define("main/directives",["main/init"],function(){function ngView(e,t,a){return{restrict:"A",priority:-500,link:function(n,i){t.remove(e.current.loadedTemplateUrl),n.mainStatus.pageParams=a}}}function convertToDate(e){var t=e("date");return{require:"ngModel",link:function(e,a,n,i){var r=n.convertToDate?n.convertToDate:"yyyy-MM-dd";i.$parsers.push(function(e){if(e)return n.format?t(e,r):e.getTime()}),i.$formatters.push(function(){return i.$modelValue?n.timestamp?new Date(i.$modelValue).getTime():new Date(i.$modelValue):null})}}}function convertToNumber(){return{require:"ngModel",link:function(e,t,a,n){n.$parsers.push(function(e){return parseInt(e,10)}),n.$formatters.push(function(e){return""+e})}}}function convertJsonToObject(){return{require:"ngModel",link:function(e,t,a,n){n.$parsers.push(function(e){return e?angular.fromJson(e):null}),n.$formatters.push(function(e){return angular.toJson(e)})}}}function ajaxUrl(e,t,a,n,i){return{restrict:"AE",transclude:!0,link:function(e,r,o,l,s){function c(l){angular.isDefined(o.ajaxIf)&&!o.ajaxIf||(e.isLoading=!0,o.showLoading&&i(r,e,"showLoading",{}),t(o.ajaxUrl,l).then(function(t){var n=t[0];e.ajaxUrlHandler&&(n=e.ajaxUrlHandler(n)),o.scopeResponse&&(e[o.scopeResponse]=t[1]),o.scopeData?e[o.scopeData]=n:e.scopeData=n,angular.isDefined(o.alertOk)&&a(t[1].msg),e.listCallback&&e.listCallback(t[1]),o.callback&&e.$eval(o.callback),$(".pr-full-loading").remove(),e.isLoading=!1})["catch"](function(t){o.scopeErrorMsg&&(e[o.scopeErrorMsg]=t),angular.isDefined(o.alertError)&&n(t),$(".pr-full-loading").remove()}))}s(e,function(e){r.append(e)}),e.ajaxUrlHandler=e.$eval(o.ajaxUrlHandler);var u={};o.params?0===o.params.indexOf("{")?o.$observe("params",function(t){u=e.$eval(t),c(u)}):e.$watch(o.params,function(e){u=e,c(u)},!0):o.$observe("ajaxUrl",function(e){c({})}),e.$on("ajaxUrlReload",function(){c(_detailsParams)})}}}function formValidator(e,t,a,n,i,r,o){return{restrict:"A",link:function(l,s,c){function u(){if(d.submitting!==!0){d.submitting=!0;var i=!1;angular.isDefined(c.parameterBody)&&(i=!0),e(c.action,l.formData,"POST",i).then(function(e){var n=e[0],i=e[1];if(d.submitting=!1,d.submitInfo="",c.scopeResponse&&(l[c.scopeResponse]=e[1]),c.scopeData&&(l[c.scopeData]=n),angular.isDefined(c.alertOk)&&a(e[1].msg),"reset"==c.formSubmitAfter&&p.reset(),c.callback&&(o("测试文字tips"),r(function(){},3e3)),c.broadcast&&(l.$broadcast(c.broadcast),l.$emit(c.broadcast)),!angular.isDefined(c.noCloseDialog)){if(i&&i.url)return void window.location.assign(i.url);angular.isFunction(l.submitCallBack)?l.submitCallBack.call(l,f,n):n&&n.url?window.location.assign(n.url):l.$broadcast("reloadList"),angular.isDefined(c.autoCloseDialog)&&t.close()}})["catch"](function(e){d.submitting=!1,d.submitInfo=e||"提交失败。",n(e)})}}var d=l.formStatus={submitted:!1,submitting:!1,submitInfo:""},p=angular.element(s)[0],f=(l.$eval(c.name),l.ngDialogData);l.formData=angular.extend({},l.formData),l.$watch(c.source,function(e){e&&angular.isObject(e)&&angular.extend(l.formData,e)}),l.reset=function(){p.reset()},s.on("submit",function(e){e.preventDefault(),c.beforeConfirmMsg?i(c.beforeConfirmMsg,function(){u()},null):u()})}}}function tableList(e,t,a,n,i){return{restrict:"AE",scope:{listParams:"=?",listSelected:"=?",listSource:"=?"},transclude:!0,require:"?^ngModel",link:function(r,o,l,s,c){function u(t){return l.listSource?void(r.listSource&&(r.tbodyList=angular.isArray(r.listSource)?r.listSource:r.listSource.list,r.listSource.options&&(f.totalCount=r.listSource.options.totalCount||f.totalCount,f.pageSize=r.listSource.options.pageSize||f.pageSize,f.totalPage=Math.ceil(f.totalCount/f.pageSize)),t&&t())):void(angular.isDefined(l.ajaxIf)&&!l.ajaxIf||f.isLoading||(f.isLoading=!0,r.isLoading=f.isLoading,i(o,r,"showLoading",{}),e(l.listData,angular.merge({},g,{pageNo:f.currentPage})).then(function(e){var a=e[1];200==a.code?(f.totalCount=a.totalCount,f.pageSize=a.pageSize,f.totalCount&&f.pageSize&&(f.totalPage=Math.ceil(f.totalCount/f.pageSize)),a.thead&&(r.theadList=a.thead),r.resultsData=a,a.data&&a.data.length>0?r.tbodyList=a.data:f.isFinished=!0,f.loadFailMsg=a.message,$(".pr-full-loading").remove()):(f.isFinished=!0,f.loadFailMsg=a.message,$(".pr-full-loading").remove()),f.isLoading=!1,r.isLoading=!1,n(p),t&&t()})["catch"](function(){f.isLoading=!1,$(".pr-full-loading").remove(),f.loadFailMsg="加载出错",t&&t()})))}function d(){var e=[];r.listSelected.length=0,$(".selectOne:checked",o).each(function(){e.push(this.value)}),[].unshift.apply(r.listSelected,e);var t=[];angular.forEach(r.tbodyList,function(e){angular.forEach(r.listSelected,function(a){e.id==a&&t.push(e)})}),s&&s.$setViewValue(t)}function p(){$(".selectOne",o).on("click",function(e){e.stopPropagation();var t=$(".selectOne",o).length,a=$(".selectOne:checked",o).length;a>0&&a<t?$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!0:t==a?$(".selectAll",o).prop("checked",!0).get(0).indeterminate=!1:$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1,d(),r.$apply()})}var f={currentPage:1,totalCount:0,pageSize:10,totalPage:1,isFinished:!1,isLoading:!1};r.mainStatus=r.$parent.mainStatus,r.parent=r.$parent,r.status=f,r.listData=l.listData,r.theadList=angular.fromJson(l.listThead),r.tbodyList=[],r.getListData=u,angular.isDefined(r.listParams)||(r.listParams={}),angular.isDefined(r.listSelected)||(r.listSelected=[]),r.delSelected=function(t){a("确定删除这些?",function(){e(t,{ids:r.listSelected.join(",")}).then(function(){r.$broadcast("reloadList")})["catch"](function(e){alert(e||"删除错误")})})},r.deleteThis=function(t,n){var i=this.tr;a("确定删除?",function(){e(t,{id:n},"POST").then(function(){r.tbodyList.splice(r.tbodyList.indexOf(i),1),0===r.tbodyList.length&&r.$broadcast("reloadList")})["catch"](function(e){alert(e||"删除错误")})})},r.dothing=function(t,n,i){var o=this.tr;a(i,function(){e(t,n,"POST").then(function(){r.tbodyList.splice(r.tbodyList.indexOf(o),1),0!==r.tbodyList.length&&r.$broadcast("reloadList")})["catch"](function(e){alert(e||"删除错误")})})},r.selectThis=function(){var e=this.tr,t=r.tbodyList.indexOf(e),a=o.find("tbody tr");a.removeClass("on").eq(t).addClass("on"),s&&s.$setViewValue(angular.copy(e))},r.changeStatus=function(t,n){var i=this.tr;a(n||"确定?",function(){e(t,{id:i.id}).then(function(e){var t=e[0],a=r.tbodyList.indexOf(i);r.tbodyList[a]=t})["catch"](function(e){alert(e||"请求失败!")})})},r.submitCallBack=function(e,a){t.closeAll(),a&&e?angular.forEach(r.tbodyList,function(t,n){t.id==e.id&&(r.tbodyList[n]=a)}):n(function(){r.$broadcast("reloadList")})};var g={};r.$on("deleteSelected",function(e,t){$(".selectOne[value="+t.id+"]",o).prop("checked",!1);var a=$(".selectOne",o).length,n=$(".selectOne:checked",o).length;n>0&&n<a?$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!0:a==n?$(".selectAll",o).prop("checked",!0).get(0).indeterminate=!1:$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1;var i=[];r.listSelected.length=0,$(".selectOne:checked",o).each(function(){i.push(this.value)}),[].unshift.apply(r.listSelected,i),d()}),r.$watchCollection("listSource",function(e){e&&u(d)}),r.$watch("listParams",function(){f.currentPage=1,f.isFinished=!1,r.tbodyList=[],g=angular.copy(r.listParams),g.q&&(g.q="(?i)"+g.q),u(d),$(".selectAll",o).length>0&&($(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1)},!0),l.$observe("listData",function(e){f.currentPage=1,f.isFinished=!1,r.tbodyList=[],g=angular.copy(r.listParams),u(d),$(".selectAll",o).length>0&&($(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1)}),r.$on("reloadList",function(){f.currentPage=1,f.isFinished=!1,r.tbodyList=[],g=angular.copy(r.listParams),u(d),$(".selectAll",o).length>0&&($(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1)}),$(o).on("click",".selectAll",function(){this.indeterminate?(this.checked=!1,$(".selectOne",o).prop("checked",!1)):$(".selectOne",o).prop("checked",this.checked),d(),r.$apply()}),c(r,function(e){o.append(e)})}}}function tableCell(){return{restrict:"AE",scope:{row:"="},replace:!0,templateUrl:Config.tplPath+"tpl/table-cell.html",link:function(e,t,a){e.cells=[],angular.isString(e.row)||angular.isNumber(e.row)?e.cells.push({text:e.row}):angular.isArray(e.row)?angular.forEach(e.row,function(t){angular.isObject(t)?e.cells.push(t):e.cells.push({text:t})}):e.cells.push(e.row)}}}function pagination(){return{restrict:"AE",scope:!0,replace:!0,templateUrl:Config.tplPath+"tpl/pagination.html",link:function(e,t,a){function n(e,t,a){return{number:e,text:t,active:a}}function i(e,t){var a=[],i=1,l=t,s=angular.isDefined(r)&&r<t;s&&(o?(i=Math.max(e-Math.floor(r/2),1),l=i+r-1,l>t&&(l=t,i=l-r+1)):(i=(Math.ceil(e/r)-1)*r+1,l=Math.min(i+r-1,t)));for(var c=i;c<=l;c++){var u=n(c,c,c===e);a.push(u)}if(s&&!o){if(i>1){var d=n(i-1,"...",!1);a.unshift(d)}if(l<t){var p=n(l+1,"...",!1);a.push(p)}}return a}var r=angular.isDefined(a.maxSize)?e.$parent.$eval(a.maxSize):10,o=!angular.isDefined(a.rotate)||e.$parent.$eval(a.rotate);e.start=function(){1!=e.status.currentPage&&(e.status.currentPage=1,e.getListData())},e.prev=function(){e.status.currentPage<=1||(e.status.currentPage--,e.getListData())},e.next=function(){e.status.currentPage>=e.status.totalPage||(e.status.currentPage++,e.getListData())},e.end=function(){e.status.currentPage!=e.status.totalPage&&(e.status.currentPage=e.status.totalPage,e.getListData())},e["goto"]=function(t){e.status.currentPage=t,e.getListData()},e.$watch("status.totalPage",function(){e.pages=i(e.status.currentPage,e.status.totalPage)}),e.$watch("status.currentPage",function(){e.pages=i(e.status.currentPage,e.status.totalPage)})}}}function pagination2(){return{restrict:"AE",scope:!0,replace:!0,templateUrl:Config.tplPath+"tpl/pagination2.html",link:function(e,t,a){e.start=function(){1!=e.status.currentPage&&(e.status.currentPage=1,e.getListData())},e.prev=function(){e.status.currentPage<=1||(e.status.currentPage--,e.getListData())},e.next=function(){e.status.currentPage>=e.status.totalPage||(e.status.currentPage++,e.getListData())},e.end=function(){e.status.currentPage!=e.status.totalPage&&(e.status.currentPage=e.status.totalPage,e.getListData())}}}}function filterConditions(e){return{restrict:"AE",scope:{},transclude:!0,link:function(t,a,n,i,r){function o(){var e={};angular.forEach(t.filterConditions.list,function(t){e[t.type]=t.id}),t.filterParams=e}t.filterParams={},t.filterConditions={list:[]};var l=t.filterConditions;t.conditionList={},t.selectCondition=function(e,t){t.type=e,l[e]=t,l.list.push(t),o()},t.deleteCondition=function(e){var t=l.list.indexOf(e);l.list.splice(t,1),delete l[e.type],o()},n.filterConditions&&!function(){e(n.filterConditions).then(function(e){var a=e[0];t.conditionList=a})}(),r(t,function(e){a.append(e)})}}}function treeList(e,t,a){return{restrict:"AE",scope:{},require:"?^ngModel",templateUrl:Config.tplPath+"tpl/tree.html",link:function(n,i,r,o){function l(){n.status.isLoading=!0,t(r.treeList).then(function(t){var o=t[0];n.treeList=e(o,r.pidKey),n.status.isLoading=!1,s&&angular.isDefined(r.selectFirst)&&(s=!1,a(function(){for(var e=i.find("em"),t=0,a=e.length;t<a&&(e.eq(t).trigger("click"),0!=e.eq(t).next("ul").length);t++);}))})["catch"](function(){n.status.isLoading=!1})}var s=!0;n.status={},n.treeList=[],n.curTree={},n.status.isLoading=!0,n.selectTree=function(e,t){var a=i.find("li"),n=$(t.currentTarget),r=n.parent("li"),l=angular.copy(e);0==l.nodes.length?(a.removeClass("on"),r.addClass("on"),o&&o.$setViewValue(l)):r.hasClass("fold")?r.removeClass("fold"):r.addClass("fold")},r.$observe("treeList",l)}}}function treeList2(e,t,a,n,i){return{restrict:"AE",require:"?^ngModel",link:function(n,r,o,l){function s(){n.status.isLoading=!0,t(o.treeList2).then(function(t){var a=t[0];n.treeList=e(a,o.pidKey),n.status.isLoading=!1})["catch"](function(){n.status.isLoading=!1})}var c=angular.isDefined(o.selectGroup);n.status={},n.treeList=[],n.curTree={},n.status.isLoading=!0,n.selectTree=function(e,t){var a=r.find("li"),n=$(t.currentTarget),i=n.parent("li"),o=angular.copy(e);0==o.nodes.length||c?(a.removeClass("on"),i.addClass("on"),delete o.nodes,l&&l.$setViewValue(o)):i.hasClass("fold")?i.removeClass("fold"):i.addClass("fold")},n.extendTree=function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget),a=t.parent().parent("li");a.hasClass("fold")?(a.removeClass("fold"),t.parent().next().hide()):(a.addClass("fold"),t.parent().next().show())},n.deleteTree=function(e,a){e.preventDefault(),e.stopPropagation(),i("是否删除?",function(){t(a).then(function(){s()})})},n.addTree=function(e,t){e.preventDefault(),e.stopPropagation(),a.closeAll(),a.open({template:t,className:"ngdialog-theme-right",cache:!1,trapFocus:!0,overlay:!1,scope:n,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(400)}]})},o.$observe("treeList2",s),n.submitCallBack=function(e,t){a.closeAll(),s()}}}}function navList(e){return{restrict:"AE",scope:!0,transclude:!0,require:"?^ngModel",link:function(t,a,n,i,r){function o(a){return n.listSource?(t.tbodyList=t.listSource,void(a&&a())):(l.isLoading=!0,void e(n.navList).then(function(e){var a=e[0];t.isLoading=!1,t.listData=a.data,t.select(t.listData[0])})["catch"](function(){t.isLoading=!1}))}r(t,function(e){a.append(e)});var l={isLoading:!0};t.status=l,t.currentSelect={};t.select=function(e){t.currentSelect=e,i&&i.$setViewValue(e)},o()}}}function selectAsync(e){return{restrict:"A",scope:{},require:"?^ngModel",link:function(t,a,n,i){e(n.selectAsync).then(function(e){var t=e[0],n='<option value="">请选择</option>';t||(t=[]);for(var r=t.length,o=0;o<r;o++)n+='<option value="'+t[o].value+'">'+t[o].text+"</option>";a.html(n),i&&a.val(i.$viewValue)})}}}function relativeSelect(e,t){return{restrict:"A",scope:{},require:"?^ngModel",link:function(a,n,i,r){function o(){var e={};e[n[0].name]=n.val(),$(s).trigger("update",e)}function l(t){e(c,t).then(function(e){var t=e[0],a=u?"":'<option value="">请选择</option>';t||(t=[]);for(var i=t.length,l="",s=0;s<i;s++)(t[s].selected||u&&0==s)&&(l=t[s].value),a+="<option "+(0===t[s].enabled?' class="text-muted"':"")+' value="'+t[s].value+'">'+t[s].text+"</option>";n.html(a),n.val(l),r&&r.$setViewValue(l),o()})}var s=i.relativeTo,c=i.relativeSelect,u=angular.isDefined(i.selectFirst),d=angular.isDefined(i.relativeInitload);n.on("change",o),n.on("update",function(e,t){
l(t)}),d&&t(o)}}}function eChart(requestData,dialogChart){return{restrict:"A",scope:{clickToUrl:"@",clickToDialog:"@",clickTopToUrl:"@",clickTopToDialog:"@",eChartKey:"@",eChartMap:"=",eChartMapData:"=",chartParams:"="},require:"?^ngModel",link:function($scope,$element,$attrs,ngModel){$scope.isLoading=!1,require(["echarts"],function(echarts){function reSize(){myChart.resize()}function loadChart(_url,_params){$scope.isLoading||($scope.isLoading=!0,myChart.showLoading(),$.ajax({url:_url,type:"GET",xhrFields:{withCredentials:!0},crossDomain:!0,dataType:"text",success:function(text){var results=eval("("+text+")");if(200!=results.code)return console.log(_data),void alertError(_data.msg||"出错了");var _data=results.data;$scope.eChartKey&&($scope.$parent.eChartMapData||($scope.$parent.eChartMapData={}),$scope.$parent.eChartMapData[$scope.eChartKey]=_data),myChart.hideLoading(),_data.polar?_data.tooltip.formatter=function(e){var t=e[0].name;return angular.forEach(e,function(e){t+="<br>"+e.seriesName+": "+e.data}),t}:_data.tooltip.formatter&&0==_data.tooltip.formatter.indexOf("function")&&(_data.tooltip.formatter=eval("("+_data.tooltip.formatter+")")),myChart.setOption(_data),$scope.isLoading=!1},error:function(e){alert("服务器连接不上或内部异常："+e.responseText)}}))}var myChart=echarts.init($element[0]);$scope.eChartKey&&($scope.$parent.eChartMap||($scope.$parent.eChartMap={}),$scope.$parent.eChartMap[$scope.eChartKey]=myChart),$(window).on("resize",reSize),$scope.$on("$destroy",function(){$(window).off("resize",reSize),myChart.dispose()}),myChart.on("click",function(e){console.log(e),console.log($scope),e.data?$scope.clickToUrl?(ngModel&&ngModel.$setViewValue(e.data),window.location.assign($scope.clickToUrl)):$scope.clickToDialog&&(ngModel&&ngModel.$setViewValue(e.data),dialogChart($scope.$parent.mainConfig.viewsDir+$scope.clickToDialog)):$scope.clickTopToUrl?(ngModel&&ngModel.$setViewValue(e),window.location.assign($scope.clickTopToUrl)):$scope.clickTopToDialog&&(ngModel&&ngModel.$setViewValue(e),dialogChart($scope.$parent.mainConfig.viewsDir+$scope.clickTopToDialog))}),angular.isDefined($attrs.chartParams)?$scope.$watch("chartParams",function(e){loadChart($attrs.chart,e)},!0):$attrs.$observe("chart",function(e){loadChart($attrs.chart)}),loadChart($attrs.chart,$scope.chartParams)})}}}function angucomplete(e,t,a,n){return{restrict:"EA",scope:{placeholder:"@",selectedItem:"=?",url:"@",titleField:"@",descriptionField:"@",searchFields:"@",matchClass:"@",ngDisabled:"=?"},require:"?^ngModel",templateUrl:Config.tplPath+"tpl/autocomplete.html",link:function(e,i,r,o){e.lastSearchTerm=null,e.currentIndex=null,e.justChanged=!1,e.searchTimer=null,e.hideTimer=null,e.searching=!1,e.pause=300,e.minLength=1,e.searchStr=null;var l=function(t,a){return t.length>=e.minLength&&t!=a};e.processResults=function(t,n){if(t&&t.length>0){e.results=[];var i=[];e.titleField&&""!=e.titleField&&(i=e.titleField.split(","));for(var r=0;r<t.length;r++){for(var o=[],l=0;l<i.length;l++)o.push(t[r][i[l]]);var s="";e.descriptionField&&(s=t[r][e.descriptionField]);var c=o.join(" ");if(e.matchClass){var u=new RegExp(n,"i"),d=c.match(u)[0];c=a.trustAsHtml(c.replace(u,'<span class="'+e.matchClass+'">'+d+"</span>"))}var p={id:t[r].id,title:c,description:s,originalObject:t[r]};e.results[e.results.length]=p}}else e.results=[]},e.searchTimerComplete=function(a){if(a.length>=e.minLength)if(e.localData){for(var n=e.searchFields.split(","),i=[],r=0;r<e.localData.length;r++){for(var o=!1,l=0;l<n.length;l++)o=o||"string"==typeof e.localData[r][n[l]]&&"string"==typeof a&&e.localData[r][n[l]].toLowerCase().indexOf(a.toLowerCase())>=0;o&&(i[i.length]=e.localData[r])}e.searching=!1,e.processResults(i,a)}else t(e.url,{q:a}).then(function(t){var n=t[0];e.searching=!1,e.processResults(n,a)})["catch"](function(t){e.searching=!1,console.error(t)})},e.hideResults=function(){e.hideTimer=n(function(){e.showDropdown=!1},e.pause)},e.resetHideResults=function(){e.hideTimer&&n.cancel(e.hideTimer)},e.hoverRow=function(t){e.currentIndex=t},e.keyPressed=function(t){38!=t.which&&40!=t.which&&13!=t.which?e.searchStr&&""!=e.searchStr?l(e.searchStr,e.lastSearchTerm)&&(e.lastSearchTerm=e.searchStr,e.showDropdown=!0,e.currentIndex=-1,e.results=[],e.searchTimer&&n.cancel(e.searchTimer),e.searching=!0,e.searchTimer=n(function(){e.searchTimerComplete(e.searchStr)},e.pause)):(e.showDropdown=!1,e.lastSearchTerm=null):t.preventDefault()},e.selectResult=function(t){e.matchClass&&(t.title=t.title.toString().replace(/(<([^>]+)>)/gi,"")),e.searchStr=e.lastSearchTerm=t.title,e.selectedItem=t,e.showDropdown=!1,e.results=[],o&&o.$setViewValue(t.id)};var s=i.find("input");s.on("keyup",e.keyPressed),i.on("keyup",function(t){40===t.which?(e.results&&e.currentIndex+1<e.results.length&&(e.currentIndex++,e.$apply(),t.preventDefault,t.stopPropagation()),e.$apply()):38==t.which?e.currentIndex>=1&&(e.currentIndex--,e.$apply(),t.preventDefault,t.stopPropagation()):13==t.which?e.results&&e.currentIndex>=0&&e.currentIndex<e.results.length?(e.selectResult(e.results[e.currentIndex]),e.$apply(),t.preventDefault,t.stopPropagation()):(e.results=[],e.$apply(),t.preventDefault,t.stopPropagation()):27==t.which?(e.results=[],e.showDropdown=!1,e.$apply()):8==t.which&&(e.selectedItem=null,e.$apply())})}}}function checkboxGroup(){return{restrict:"A",scope:{checkboxGroup:"="},link:function(e,t,a){angular.isArray(e.checkboxGroup)||(e.checkboxGroup=[]),t.on("click",function(){var n=-1;angular.isArray(e.checkboxGroup)||(e.checkboxGroup=[]),angular.isArray(e.checkboxGroup)&&(n=e.checkboxGroup.indexOf(a.value)),t[0].checked?n===-1&&e.checkboxGroup.push(a.value):n!==-1&&e.checkboxGroup.splice(n,1),e.$apply()}),e.$watchCollection("checkboxGroup",function(n){n&&e.checkboxGroup.indexOf(a.value)!==-1&&(t[0].checked=!0)})}}}function chosen(e,t,a,n,i){return{restrict:"A",require:"?^ngModel",link:function(r,o,l,s){function c(){var e={};e.value=o.val(),r[l.selectCallBack](e)}var u={search_contains:!0,no_results_text:"没有找到",display_selected_options:!1};l.selectCallBack&&(o.on("change",c),o.on("update",function(e,t){getData(t)}));var d=null;l.clearWatchScope&&r.$watch(l.clearWatchScope,function(e,a){d&&!e&&t(function(){d.data("chosen").form_field_jq.trigger("change")},800)}),l.width&&(u.width=l.width),require(["chosen"],function(){function c(e){var t=$("option:selected",o).not(":empty").clone().attr("selected",!0);g&&g.abort(),g=$.ajax({url:C,type:"GET",xhrFields:{withCredentials:!0},crossDomain:!0,data:{q:e,id:s.$viewValue},dataType:"json",success:function(n){if(200==n.code){a.isLoading=!1;var i="";n.data||(n.data=[]),0===n.data.length&&n.data.push({value:"",text:""});for(var r=n.data.length,c=angular.isArray(s.$viewValue)?s.$viewValue:[s.$viewValue],u=n.data,d=0;d<r;d++)i+='<option value="'+u[d].value+'"'+(c.indexOf(u[d].value)>-1?"selected":"")+">"+u[d].text+"</option>";o.html(i).prepend(t),o.trigger("chosen:updated");var p=$.Event("keydown");p.which=39,h.val(e).trigger(p),n.data.length>0?m.find(".no-results").hide():m.find(".no-results").show()}else angular.isDefined(l.alertError)&&alet(n.msg)},complete:function(){r.$digest()}})}function p(e){var a=$(this);if(e.keyCode&&13===e.keyCode&&!s.$viewValue)try{s.$setViewValue(d[0][0].value)}catch(e){}if("paste"===e.type&&a.is(":not(:focus)")||e.keyCode&&(9===e.keyCode||13===e.keyCode||16===e.keyCode||17===e.keyCode||18===e.keyCode||19===e.keyCode||20===e.keyCode||27===e.keyCode||33===e.keyCode||34===e.keyCode||35===e.keyCode||36===e.keyCode||37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode||44===e.keyCode||45===e.keyCode||144===e.keyCode||145===e.keyCode||91===e.keyCode||93===e.keyCode||224===e.keyCode||e.keyCode>=112&&e.keyCode<=123))return!1;if(y&&32!=e.keyCode&&(e.keyCode<48||e.keyCode>57))return!1;m.find(".no-results").hide();var n=$.trim(a.val());return!(!n&&v==n)&&(i(o,r,!1,{}),b=!0,r.searchTimer&&t.cancel(r.searchTimer),void(r.searchTimer=t(function(){b=!1,c(n)},500)))}function f(){angular.isDefined(l.ajaxIf)&&!l.ajaxIf||e(l.selectSource).then(function(e){var t=e[0],a="";t||(t=[]);var n=t.length,i=null;i=angular.isDefined(l.multiple)?angular.isDefined(l.defaultEmpty)?s.$viewValue?s.$viewValue:[]:s.$viewValue?s.$viewValue:[t[0].value]:angular.isDefined(l.defaultEmpty)?s.$viewValue?s.$viewValue:"":s.$viewValue?s.$viewValue:t[0].value,angular.isDefined(l.defaultEmpty)&&(a+='<option value=""  >'+l.defaultEmpty+"</option>");for(var c=0;c<n;c++)a+='<option value="'+t[c].value+'"'+(i.indexOf(t[c].value)>-1?"selected":"")+">"+t[c].text+"</option>";o.html(a),d=o.chosen(r.chosen||u),s.$setViewValue(i)})["catch"](function(e){l.scopeErrorMsg&&(r[l.scopeErrorMsg]=e),angular.isDefined(l.alertError)&&n(e)})}if(l.selectSource)if(angular.isDefined(l.chosenAjax)){d=o.chosen(u);var g,m=o.next(),h=$("input",m),v="",y=!1,b=!1,C=l.selectSource;Config.serverPath&&0!==C.indexOf("http://")&&0!==C.indexOf("https://")&&(C=Config.serverPath+C),s.$viewValue&&c(""),$(".chosen-search > input, .chosen-choices .search-field input",m).on("keyup",p).on("paste",function(e){var t=this;setTimeout(function(){p.call(t,e)},500)}).on("keydown",function(e){y=229==e.keyCode}).on("blur",function(e){if(!s.$viewValue)try{d&&d.data("chosen").single_set_selected_text()}catch(e){}})}else l.$observe("selectSource",function(e){s.$setViewValue(null),d&&d.data("chosen").destroy(),f()}),f();else o.append("<option value=''></option>"),o.chosen(r.chosen||u)})}}}function formItem(e){return{restrict:"AE",scope:!0,replace:!0,link:function(t,a,n){var i=t.$eval(n.src),r="";switch(i.type){case"text":r='<input type="'+i.type+'" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+'\']" class="ipt" placeholder="'+i.placeholder+'" />';break;case"hidden":r='<input type="'+i.type+'" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+"']\"/>";break;case"date":r='<input type="'+i.type+'" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+'\']" class="ipt" placeholder="'+i.placeholder+'" convert-to-date/>';break;case"checkbox":r='<div class="form-ctrl" ng-init="formData[\''+i.key+"']=['"+(i.value||"")+"']\">",angular.forEach(i.options,function(e){r+='<label class="label"><input type="'+i.type+'" name="'+i.key+'" checkbox-group="formData[\''+i.key+'\']"  value="'+e+'" /> '+e+"</label>"}),r+="</div>";break;case"radio":r='<div class="form-ctrl" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\">",angular.forEach(i.options,function(e){r+='<label class="label"><input type="'+i.type+'" name="'+i.key+'" ng-model="formData[\''+i.key+'\']"  value="'+e+'" /> '+e+"</label>"}),r+="</div>";break;case"select":r='<select class="select select-w" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+"']\"  >",r+='<option value="" >请选择</option>',angular.forEach(i.options,function(e){r+='<option value="'+e+'" >'+e+"</option>"}),r+="</select>";break;case"textarea":r='<textarea name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+'\']"  class="textarea" placeholder="'+i.placeholder+'"></textarea>'}a.append(e(r)(t))}}}function customConfig(e){return{restrict:"AE",scope:!0,transclude:!0,require:"?^ngModel",link:function(t,a,n,i,r){e(function(){i&&(t.dataList=i.$viewValue||[])}),t.$watchCollection("dataList",function(e){e&&i&&i.$setViewValue(e)}),t.addRow=function(){t.dataList.push({})},t.delRow=function(e){t.dataList.splice(e,1)},r(t,function(e){a.append(e)})}}}function autoComplete(){return{restrict:"AE",scope:!0,transclude:!0,require:"?^ngModel",link:function(e,t,a,n,i){var r={parse:function(e){var t=[];if(!e||!e.data)return t;for(var a=e.data,n=0;n<a.length;n++){var i=$.trim(a[n]);i&&(row=i.split("|"),t[t.length]={data:i,value:row[0],result:row[0]})}return t},formatItem:function(e){return e},noRecord:"没匹配数据",dataType:"json"};require(["autocomplete"],function(){if(a.autoComplete){var e=a.autoComplete;Config.serverPath&&0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&(e=Config.serverPath+e);var n=null;t.focus(function(){null==n&&(r.width=t.css("width"),n=t.autocomplete(e,r),n.result(function(e,t,a){console.log(t)}))})}})}}}function selectAddress(e,t,a){var n,i,r;return i=t.defer(),r=Config.tplPath+"tpl/cascading-select-address/cascading-select-address.html",n=Config.tplPath+"tpl/cascading-select-address/city.min.js",e.get(n).success(function(e){return i.resolve(e)}),{restrict:"A",scope:{p:"=",a:"=",c:"=",d:"=",ngModel:"="},link:function(t,n,o){var l;return l={element:null,backdrop:null,show:function(){return this.element.addClass("active")},hide:function(){return this.element.removeClass("active"),!1},resize:function(){if(this.element)return this.element.css({top:-this.element.height()-30,"margin-left":-this.element.width()/2}),!1},focus:function(){return $('[ng-model="d"]').focus(),!1},init:function(){return n.on("click keydown",function(){return l.show(),event.stopPropagation(),!1}),this.element.on("click",function(){return event.stopPropagation()}),setTimeout(function(e){return function(){return e.element.show(),e.resize()}}(this),500)}},i.promise.then(function(n){return e.get(r).success(function(e){var i;return i=a(e)(t),$("body").append(i),l.element=$(i[2]),t.provinces=n,l.init()}),t.aSet={p:function(e){return t.p=e,t.c=null,t.a=null,t.d=null},c:function(e){return t.c=e,t.a=null,t.d=null},a:function(e){return t.a=e,t.d=null,l.focus()}},t.clear=function(){return t.p=null,t.c=null,t.a=null,t.d=null},t.submitAddress=function(){return l.hide()},t.$watch("p",function(e){var a,i,r,o;if(e)for(o=[],i=0,r=n.length;i<r;i++)a=n[i],a.p===e&&o.push(t.cities=a.c);return t.cities?o:(t.cities=[],t.cities)}),t.$watch("c",function(e){var a,n,i,r,o;if(e){for(r=t.cities,o=[],n=0,i=r.length;n<i;n++)a=r[n],a.n===e&&o.push(t.dists=a.a);return o}return t.dists=[]}),t.$watch(function(){return t.ngModel="",t.p&&(t.ngModel+=t.p),t.c&&(t.ngModel+=" "+t.c),t.a&&(t.ngModel+=" "+t.a),t.d&&(t.ngModel+=" "+t.d),l.resize()})})}}}convertToDate.$inject=["$filter"],convertToNumber.$inject=[],convertJsonToObject.$inject=[],tableList.$inject=["requestData","modal","dialogConfirm","$timeout","proLoading"],filterConditions.$inject=["requestData"],treeList.$inject=["buildTree","requestData","$timeout"],treeList2.$inject=["buildTree","requestData","modal","$timeout","dialogConfirm"],navList.$inject=["requestData"],selectAsync.$inject=["requestData"],relativeSelect.$inject=["requestData","$timeout"],eChart.$inject=["requestData","dialogChart"],angucomplete.$inject=["$parse","requestData","$sce","$timeout"],chosen.$inject=["requestData","$timeout","$rootScope","alertError","proLoading"],formItem.$inject=["$compile"],customConfig.$inject=["$timeout"],selectAddress.$inject=["$http","$q","$compile"],angular.module("manageApp.main").directive("ngView",["$route","$templateCache","$routeParams",ngView]).directive("convertToDate",convertToDate).directive("convertToNumber",convertToNumber).directive("convertJsonToObject",convertJsonToObject).directive("ajaxUrl",["$timeout","requestData","alertOk","alertError","proLoading",ajaxUrl]).directive("formValidator",["requestData","modal","alertOk","alertError","dialogConfirm","$timeout","proMessageTips",formValidator]).directive("tableList",tableList).directive("tableCell",tableCell).directive("pagination",pagination).directive("pagination2",pagination2).directive("filterConditions",filterConditions).directive("treeList",treeList).directive("treeList2",treeList2).directive("navList",navList).directive("selectAsync",selectAsync).directive("relativeSelect",relativeSelect).directive("chart",eChart).directive("angucomplete",angucomplete).directive("checkboxGroup",checkboxGroup).directive("chosen",chosen).directive("formItem",formItem).directive("autoComplete",autoComplete).directive("selectAddress",["$http","$q","$compile",selectAddress]).directive("customConfig",customConfig)}),define("main/filters",["main/init"],function(){angular.module("manageApp.main")}),define("main/init",["angular"],function(){angular.module("manageApp.main",[])}),define("main/services",["main/init"],function(){function e(e,t){return{response:function(e){return"string"==typeof e.data&&/^<!DOCTYPE html>/.test(e.data)?(window.location.assign(e.config.url),e):e}}}function t(e,t,a){return function(n,i,r,o){var l=e.defer();r||(r="GET");Config.serverPath&&0!==n.indexOf("http://")&&0!==n.indexOf("https://")&&(n=Config.serverPath+n),i&&"GET"==r&&(n+=(n.indexOf("?")==-1?"?":"&")+a(i));var s={method:r,url:n,data:i||{},withCredentials:!0,headers:{"Content-Type":"application/json;charset=utf-8","X-Requested-With":"XMLHttpRequest"}};return o||(s.transformRequest=function(e){return a(e)},s.headers={"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}),t(s).success(function(e,t,a,n){200==t&&200==e.code?l.resolve([e.data,e]):l.reject(e.msg||"出错了")}).error(function(){l.reject("提交失败!")}),l.promise}}function a(e,t){return function(a,n,i){var r=e.$new(!1),o="";o=i&&"pr"===i?"tpl/pr-dialog-confirm.html":"tpl/dialog-confirm.html",r.confirmText=a||"确定删除?",t.openConfirm({template:Config.tplPath+o,scope:r}).then(n)}}function n(e,t){return function(a,n){var i=e.$new(!1);i.confirmText=a||"确定",t.openConfirm({template:Config.tplPath+"tpl/dialog-alert.html",scope:i}).then(n)}}function i(e,t){return function(a,n){var i=e.$new(!1);i.confirmText=a||"确定",t.openConfirm({template:Config.tplPath+"tpl/dialog-alert.html",scope:i}).then(n)}}function r(e,t){return function(a,n){var i=e.$new(!1);i.confirmText=a||"确定",t.openConfirm({template:Config.tplPath+"tpl/dialog-alert.html",scope:i}).then(n)}}function o(e,t){return function(a,n){var i=e.$new(!1);i.content=a,t.openConfirm({template:Config.tplPath+"tpl/dialog-center.html",scope:i}).then(n)}}function l(e,t,a){return function(a){var n=e.$new(!1),i={},r=a.split("?");r[1]&&angular.forEach(r[1].split("&"),function(e){var t=e.split("=");i[t[0]]=t[1]}),n.url=a,n.urlParams=i,t.open({template:Config.tplPath+"tpl/dialog-center.html",scope:n})}}function s(){return function(e,t){if(!e||0===e.length)return[];var a={},n=[],i=0;t||(t="pid");for(var i=0;i<e.length;i++){var r=e[i];r.nodes=[],a[r.id]=r}for(var i=0;i<e.length;i++){var r=e[i];if(null!=r)if(r[t]&&"0"!=r[t]){var o=a[r[t]];null==o?n.push(r):o.nodes.push(r)}else n.push(r)}return n}}function c(){return function(e,t,a,n){var i=({_style:n.style?n.style:"circular-rota",_masklayer:!!n.masklayer&&n.masklayer,_message:n.message?n.message:""},'<div class="pr-spinner" style="position:absolute;top:20%;left:102%;"><div class="bar1 cblack"></div><div class="bar2 cblack"></div><div class="bar3 cblack"></div><div class="bar4 cblack"></div><div class="bar5 cblack"></div><div class="bar6 cblack"></div><div class="bar7 cblack"></div><div class="bar8 cblack"></div><div class="bar9 cblack"></div><div class="bar10 cblack"></div><div class="bar11 cblack"></div><div class="bar12 cblack"></div></div>'),r='<div class="pr-full-loading" style="width:80px;height:80px;position:fixed;_position:absolute;top:50%;left:50%;z-index:100;border-radius:5px;opacity:0.4;filter:alpha(opacity=30);background-color:#000;transform:translateX(-50%) translateY(-50%);"><div style="position:absolute;top:50%;left:50%;transform:translateX(-40%) translateY(-40%);" class="pr-spinner"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div><div class="bar4"></div><div class="bar5"></div><div class="bar6"></div><div class="bar7"></div><div class="bar8"></div><div class="bar9"></div><div class="bar10"></div><div class="bar11"></div><div class="bar12"></div></div></div>',o=e,l=t;if(a){var s=$("."+a);s.css("relative")||s.addClass("relative"),l.isLoading&&$(".sticky-header").append(r)}else o.parent().append(i),l.isLoading=!0,l.$watch(l.isLoading,function(){$(".pr-spinner").remove()})}}e.$inject=["$q","$location"],t.$inject=["$q","$http","$httpParamSerializer"],a.$inject=["$rootScope","modal"],n.$inject=["$rootScope","modal"],o.$inject=["$rootScope","modal"],l.$inject=["$rootScope","modal","$http"],c.$inject=[],angular.module("manageApp.main").factory("redirectInterceptor",e).service("alertOk",["$rootScope","modal",i]).service("alertError",["$rootScope","modal",r]).service("alertWarn",["$rootScope","modal",r]).service("requestData",t).service("dialogConfirm",a).service("dialogAlert",n).service("dialog",o).service("dialogChart",l).service("buildTree",s).factory("proLoading",c).config(["$httpProvider",function(e){e.interceptors.push("redirectInterceptor")}])}),define("modal/directives",["modal/init"],function(){function e(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){a.on("click",function(a){a.preventDefault();var i=angular.isDefined(t.modalScope)?t.modalScope:"noScope";angular.isDefined(n.ngDialogClosePrevious)&&e.close(n.ngDialogClosePrevious);var r=e.getDefaults();e.open({template:n.ngDialog,className:n.ngDialogClass||r.className,controller:n.ngDialogController,controllerAs:n.ngDialogControllerAs,bindToController:n.ngDialogBindToController,scope:i,data:n.ngDialogData,showClose:"false"!==n.ngDialogShowClose&&("true"===n.ngDialogShowClose||r.showClose),closeByDocument:"false"!==n.ngDialogCloseByDocument&&("true"===n.ngDialogCloseByDocument||r.closeByDocument),closeByEscape:"false"!==n.ngDialogCloseByEscape&&("true"===n.ngDialogCloseByEscape||r.closeByEscape),overlay:"false"!==n.ngDialogOverlay&&("true"===n.ngDialogOverlay||r.overlay),preCloseCallback:n.ngDialogPreCloseCallback||r.preCloseCallback})})}}}function t(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){var i=n.modalRight||"50%";a.on("click",function(a){a.preventDefault(),e.closeAll(),e.open({template:n.modalUrl,className:"ngdialog-theme-right",cache:!1,trapFocus:!0,overlay:"true"==n.modalOverlay,data:n.modalData||t.modalScope.tr,scope:t.modalScope,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(i)}]})})}}}function a(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){var i=n.modalCenter||"50%";a.on("click",function(a){a.preventDefault(),e.open({template:n.modalUrl,cache:!1,trapFocus:!1,data:n.modalData||t.modalScope.tr,scope:t.modalScope,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(i)}]})})}}}e.$inject=["modal"],t.$inject=["modal"],a.$inject=["modal"],angular.module("manageApp.modal").directive("modal",e).directive("modalRight",t).directive("modalCenter",a)}),define("modal/init",["angular"],function(){angular.module("manageApp.modal",[])}),define("modal/services",["modal/init"],function(){"use strict";var e=angular.module("manageApp.modal"),t=angular.element,a=angular.isDefined,n=(document.body||document.documentElement).style,i=a(n.animation)||a(n.WebkitAnimation)||a(n.MozAnimation)||a(n.MsAnimation)||a(n.OAnimation),r="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",o="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",l="ngdialog-disabled-animation",s={html:!1,body:!1},c={},u=[],d=!1,p=!1;e.provider("modal",function(){var e=this.defaults={className:"ngdialog-theme-default",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceHtmlReload=function(e){s.html=e||!1},this.setForceBodyReload=function(e){s.body=e||!1},this.setDefaults=function(t){angular.extend(e,t)},this.setOpenOnePerName=function(e){p=e||!1};var a,n=0,f=0,g={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(m,h,v,y,$,b,C,k,w,D){var x=[],S={onDocumentKeydown:function(e){27===e.keyCode&&A.close("$escape")},activate:function(e){var t=e.data("$ngDialogOptions");t.trapFocus&&(e.on("keydown",S.onTrapFocusKeydown),x.body.on("keydown",S.onTrapFocusKeydown))},deactivate:function(e){e.off("keydown",S.onTrapFocusKeydown),x.body.off("keydown",S.onTrapFocusKeydown)},deactivateAll:function(e){angular.forEach(e,function(e){var t=angular.element(e);S.deactivate(t)})},setBodyPadding:function(e){var t=parseInt(x.body.css("padding-right")||0,10);x.body.css("padding-right",t+e+"px"),x.body.data("ng-dialog-original-padding",t),b.$broadcast("ngDialog.setPadding",e)},resetBodyPadding:function(){var e=x.body.data("ng-dialog-original-padding");e?x.body.css("padding-right",e+"px"):x.body.css("padding-right",""),b.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,t){var n=e.data("$ngDialogOptions"),o=e.attr("id"),l=c[o];if(l){if("undefined"!=typeof k.Hammer){var s=l.hammerTime;s.off("tap",a),s.destroy&&s.destroy(),delete l.hammerTime}else e.unbind("click");1===f&&x.body.unbind("keydown",S.onDocumentKeydown),e.hasClass("ngdialog-closing")||(f-=1);var p=e.data("$ngDialogPreviousFocus");p&&p.focus&&p.focus(),b.$broadcast("ngDialog.closing",e,t),f=f<0?0:f,i&&!n.disableAnimation?(l.$destroy(),e.unbind(r).bind(r,function(){S.closeDialogElement(e,t)}).addClass("ngdialog-closing")):(l.$destroy(),S.closeDialogElement(e,t)),g[o]&&(g[o].resolve({id:o,value:t,$dialog:e,remainingDialogs:f}),delete g[o]),c[o]&&delete c[o],u.splice(u.indexOf(o),1),u.length||(x.body.unbind("keydown",S.onDocumentKeydown),d=!1)}},closeDialogElement:function(e,t){e.remove(),0===f&&(x.html.removeClass("ngdialog-open"),x.body.removeClass("ngdialog-open"),S.resetBodyPadding()),b.$broadcast("ngDialog.closed",e,t)},closeDialog:function(e,t){var a=e.data("$ngDialogPreCloseCallback");if(a&&angular.isFunction(a)){var n=a.call(e,t);angular.isObject(n)?n.closePromise?n.closePromise.then(function(){S.performCloseDialog(e,t)}):n.then(function(){S.performCloseDialog(e,t)},function(){}):n!==!1&&S.performCloseDialog(e,t)}else S.performCloseDialog(e,t)},onTrapFocusKeydown:function(e){var t,a=angular.element(e.currentTarget);if(a.hasClass("ngdialog"))t=a;else if(t=S.getActiveDialog(),null===t)return;var n=9===e.keyCode,i=e.shiftKey===!0;n&&S.handleTab(t,e,i)},handleTab:function(e,t,a){var n=S.getFocusableElements(e);if(0===n.length)return void(document.activeElement&&document.activeElement.blur());var i=document.activeElement,r=Array.prototype.indexOf.call(n,i),o=r===-1,l=0===r,s=r===n.length-1,c=!1;a?(o||l)&&(n[n.length-1].focus(),c=!0):(o||s)&&(n[0].focus(),c=!0),c&&(t.preventDefault(),t.stopPropagation())},autoFocus:function(e){var a=e[0],n=a.querySelector("*[autofocus]");if(null===n||(n.focus(),document.activeElement!==n)){var i=S.getFocusableElements(e);if(i.length>0)return void i[0].focus();var r=S.filterVisibleElements(a.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(r.length>0){var o=r[0];t(o).attr("tabindex","-1").css("outline","0"),o.focus()}}},getFocusableElements:function(e){var t=e[0],a=t.querySelectorAll(o),n=S.filterTabbableElements(a);return S.filterVisibleElements(n)},filterTabbableElements:function(e){for(var a=[],n=0;n<e.length;n++){var i=e[n];"-1"!==t(i).attr("tabindex")&&a.push(i)}return a},filterVisibleElements:function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];(n.offsetWidth>0||n.offsetHeight>0)&&t.push(n)}return t},getActiveDialog:function(){var e=document.querySelectorAll(".ngdialog");return 0===e.length?null:t(e[e.length-1])},applyAriaAttributes:function(e,t){if(t.ariaAuto){if(!t.ariaRole){var a=S.getFocusableElements(e).length>0?"dialog":"alertdialog";t.ariaRole=a}t.ariaLabelledBySelector||(t.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),t.ariaDescribedBySelector||(t.ariaDescribedBySelector="article,section,p")}t.ariaRole&&e.attr("role",t.ariaRole),S.applyAriaAttribute(e,"aria-labelledby",t.ariaLabelledById,t.ariaLabelledBySelector),S.applyAriaAttribute(e,"aria-describedby",t.ariaDescribedById,t.ariaDescribedBySelector)},applyAriaAttribute:function(e,a,n,i){if(n&&e.attr(a,n),i){var r=e.attr("id"),o=e[0].querySelector(i);if(!o)return;var l=r+"-"+a;return t(o).attr("id",l),e.attr(a,l),l}},detectUIRouter:function(){try{return angular.module("ui.router"),!0}catch(e){return!1}},getRouterLocationEventName:function(){return S.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},A={__PRIVATE__:S,open:function(i){function r(e,t){return b.$broadcast("ngDialog.templateLoading",e),$.get(e,t||{}).then(function(t){return b.$broadcast("ngDialog.templateLoaded",e),t.data||""})}function o(e){return e?angular.isString(e)&&m.plain?e:"boolean"!=typeof m.cache||m.cache?r(e,{cache:h}):r(e,{cache:!1}):"Empty template"}var s=null;if(i=i||{},!(p&&i.name&&(s=i.name+" dialog",this.isOpen(s)))){var m=angular.copy(e),P=++n;s=s||"ngdialog"+P,u.push(s),angular.extend(m,i);var L;g[s]=L=y.defer();var M;c[s]=M=angular.isObject(m.scope)?m.scope.$new():b.$new();var T,_,q=angular.extend({},m.resolve);return angular.forEach(q,function(e,t){q[t]=angular.isString(e)?D.get(e):D.invoke(e,null,null,t)}),y.all({template:o(m.template||m.templateUrl),locals:y.all(q)}).then(function(e){var n=e.template,i=e.locals;m.showClose&&(n+='<div class="ngdialog-close"></div>');var r=m.overlay?"":" ngdialog-no-overlay";if(T=t('<div id="'+s+'" class="ngdialog'+r+'"></div>'),T.html(m.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+n+"</div>":'<div class="ngdialog-content" role="document">'+n+"</div>"),T.data("$ngDialogOptions",m),M.ngDialogId=s,m.data&&angular.isString(m.data)){var o=m.data.replace(/^\s*/,"")[0];M.ngDialogData="{"===o||"["===o?angular.fromJson(m.data):new String(m.data),M.dialogData=angular.copy(M.ngDialogData),M.ngDialogData.ngDialogId=s}else m.data&&angular.isObject(m.data)&&(M.ngDialogData=m.data,M.dialogData=angular.copy(M.ngDialogData),M.ngDialogData.ngDialogId=s);if(m.className&&T.addClass(m.className),m.disableAnimation&&T.addClass(l),_=m.appendTo&&angular.isString(m.appendTo)?angular.element(document.querySelector(m.appendTo)):x.body,S.applyAriaAttributes(T,m),m.preCloseCallback){var c;angular.isFunction(m.preCloseCallback)?c=m.preCloseCallback:angular.isString(m.preCloseCallback)&&M&&(angular.isFunction(M[m.preCloseCallback])?c=M[m.preCloseCallback]:M.$parent&&angular.isFunction(M.$parent[m.preCloseCallback])?c=M.$parent[m.preCloseCallback]:b&&angular.isFunction(b[m.preCloseCallback])&&(c=b[m.preCloseCallback])),c&&T.data("$ngDialogPreCloseCallback",c)}if(M.closeThisDialog=function(e){S.closeDialog(T,e)},m.controller&&(angular.isString(m.controller)||angular.isArray(m.controller)||angular.isFunction(m.controller))){var u;m.controllerAs&&angular.isString(m.controllerAs)&&(u=m.controllerAs);var p=w(m.controller,angular.extend(i,{$scope:M,$element:T}),!0,u);m.bindToController&&angular.extend(p.instance,{ngDialogId:M.ngDialogId,ngDialogData:M.ngDialogData,closeThisDialog:M.closeThisDialog}),T.data("$ngDialogControllerController",p())}if(C(function(){var e=document.querySelectorAll(".ngdialog");S.deactivateAll(e),v(T)(M);var t=k.innerWidth-x.body.prop("clientWidth");x.html.addClass("ngdialog-open"),x.body.addClass("ngdialog-open");var a=t-(k.innerWidth-x.body.prop("clientWidth"));a>0&&S.setBodyPadding(a),_.append(T),S.activate(T),m.trapFocus&&S.autoFocus(T),m.name?b.$broadcast("ngDialog.opened",{dialog:T,name:m.name}):b.$broadcast("ngDialog.opened",T)}),d||(x.body.bind("keydown",S.onDocumentKeydown),d=!0),m.closeByNavigation){var g=S.getRouterLocationEventName();b.$on(g,function(){S.closeDialog(T)})}if(m.preserveFocus&&T.data("$ngDialogPreviousFocus",document.activeElement),a=function(e){var a=!!m.closeByDocument&&t(e.target).hasClass("ngdialog-overlay"),n=t(e.target).hasClass("ngdialog-close");(a||n)&&A.close(T.attr("id"),n?"$closeButton":"$document")},"undefined"!=typeof k.Hammer){var h=M.hammerTime=k.Hammer(T[0]);h.on("tap",a)}else T.bind("click",a);return f+=1,A}),{id:s,closePromise:L.promise,close:function(e){S.closeDialog(T,e)}}}},openConfirm:function(a){var n=y.defer(),i=angular.copy(e);
a=a||{},angular.extend(i,a),i.scope=angular.isObject(i.scope)?i.scope.$new():b.$new(),i.scope.confirm=function(e){n.resolve(e);var a=t(document.getElementById(r.id));S.performCloseDialog(a,e)};var r=A.open(i);if(r)return r.closePromise.then(function(e){return e?n.reject(e.value):n.reject()}),n.promise},isOpen:function(e){var a=t(document.getElementById(e));return a.length>0},close:function(e,a){var n=t(document.getElementById(e));if(n.length)S.closeDialog(n,a);else if("$escape"===e){var i=u[u.length-1];n=t(document.getElementById(i)),n.data("$ngDialogOptions").closeByEscape&&S.closeDialog(n,"$escape")}else A.closeAll(a);return A},closeAll:function(e){for(var a=document.querySelectorAll(".ngdialog"),n=a.length-1;n>=0;n--){var i=a[n];S.closeDialog(t(i),e)}},getOpenDialogs:function(){return u},getDefaults:function(){return e}};return angular.forEach(["html","body"],function(e){if(x[e]=m.find(e),s[e]){var t=S.getRouterLocationEventName();b.$on(t,function(){x[e]=m.find(e)})}}),A}]})}),define("upload/directives",["upload/init"],function(){function e(){return{restrict:"EA",scope:{ngModel:"=",uploadMax:"@",uploadSize:"@",width:"@",height:"@"},replace:!0,templateUrl:Config.tplPath+"tpl/uploader.html",link:function(e,t,a){function n(){for(var t=o[0].files,a=0,n=t.length;a<n;a++){if(t[a].size/1024>e.uploadSize)return void alert("文件大小不能超过 "+e.uploadSize+" K");switch(l){case"*":var i={status:"uploading",file:t[a],progress:0,text:"上传中...",name:t[a].name,data:{}};e.fileList.push(i),r(i);break;case"image":if(/image/g.test(t[a].type)){var i={status:"uploading",file:t[a],progress:0,text:"上传中...",name:t[a].name,data:{},imgSrc:window.URL.createObjectURL(new Blob([t[a]],{type:t[a].type}))};e.fileList.push(i),e.$digest(),r(i)}else alert("只能上传图片");break;default:if(!t[a].type||new RegExp(l).test(t[a].type)){var i={status:"uploading",file:t[a],progress:0,text:"上传中...",data:{}};e.fileList.push(i),e.$digest(),r(i)}else alert("上传格式错误")}}}function i(t){var a=[],n=e.fileList.indexOf(t);n>-1&&e.fileList.splice(n,1),angular.forEach(e.fileList,function(e,t){a.push(e.data.id)}),e.ngModel=a}function r(t){var n=new XMLHttpRequest,i=new FormData;i.append("fileData",t.file),n.upload.addEventListener("progress",function(a){var n=Math.round(100*a.loaded/a.total);100==n&&(n=99),t.progress=n,e.$digest()},!1),n.addEventListener("load",function(a){var n=angular.fromJson(a.target.responseText);t.progress=100,t.status="finished",t.text="上传成功！",t.data=n.data,e.ngModel.push(n.data.id),e.$apply(),o.val("")},!1),n.addEventListener("loadend",function(a){200!=a.target.status&&(t.status="error",t.text="上传失败！",e.$apply())});var r=a.uploader;Config.serverPath&&0!==r.indexOf("http://")&&0!==r.indexOf("https://")&&(r=Config.serverPath+r),n.open("POST",r),n.withCredentials=!0,n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(i)}var o=$('<input type="file" multiple/>'),l=a.uploadType||"image",s=angular.fromJson(a.files||[]);e.fileList=[],e.delFile=i,e.ngModel=e.ngModel||[],e.uploadMax=e.uploadMax||99,e.uploadSize=e.uploadSize||1e4,e.width=e.width?e.width:"120px",e.height=e.height?e.height:"100px",e.styleName=a.styleName||"styleName",angular.forEach(s,function(t){t.data=angular.copy(t),t.status="finished",/\.(jpe?g|png|gif)$/.test(t.url)&&(t.imgSrc=t.url),e.fileList.push(t),e.ngModel.push(t.id)}),e.$parent.resetPic=function(){e.ngModel=[],e.fileList=[]},e.uploadBtn_click=function(){o.trigger("click")};var c=$(".uploadBtn",t);c.on("click",function(){o.trigger("click")}),o.on("change",n)}}}function t(e){return{restrict:"EA",scope:{ngModel:"=",upFile:"=",uploadSize:"@",width:"@",height:"@"},link:function(t,a,n){function i(){for(var e=l[0].files,a=0,n=e.length;a<n;a++){if(e[a].size/1024>t.uploadSize)return void alert("文件大小不能超过 "+t.uploadSize+" K");switch(s){case"*":var i={status:"uploading",file:e[a],progress:0,text:"上传中...",name:e[a].name,data:""};t.upFile=i,o(i);break;case"image":if(/image/g.test(e[a].type)){var i={status:"uploading",file:e[a],progress:0,text:"上传中...",name:e[a].name,data:"",imgSrc:window.URL.createObjectURL(new Blob([e[a]],{type:e[a].type}))};t.upFile=i,t.$digest(),o(i)}else alert("只能上传图片");break;default:if(!e[a].type||new RegExp(s).test(e[a].type)){var i={status:"uploading",file:e[a],progress:0,text:"上传中...",data:{}};t.upFile=i,t.$digest(),o(i)}else alert("上传格式错误")}}}function r(e){t.ngModel=""}function o(a){var i=new XMLHttpRequest,r=new FormData;r.append("desc","desc1"),r.append("fileData",a.file),i.upload.addEventListener("progress",function(e){var n=Math.round(100*e.loaded/e.total);100==n&&(n=99),a.progress=n,t.$digest()},!1),i.addEventListener("load",function(n){var i=angular.fromJson(n.target.responseText);return i&&200==i.code?(a.progress=100,a.status="finished",a.text="上传成功！",a.data=i.data,t.ngModel=i.data,t.$apply(),void l.val("")):void e(i.msg||"出错了")},!1),i.addEventListener("loadend",function(e){200!=e.target.status&&(a.status="error",a.text="上传失败！")});var o=n.uploaderOne;Config.serverPath&&0!==o.indexOf("http://")&&0!==o.indexOf("https://")&&(o=Config.serverPath+o),i.open("POST",o),i.withCredentials=!0,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(r)}var l=$('<input type="file"/>'),s=n.uploadType||"image";t.delFile=r,t.ngModel=t.ngModel,t.uploadSize=t.uploadSize||1e4,t.width=t.width?t.width:"120px",t.height=t.height?t.height:"100px",t.styleName=n.styleName||"styleName",t.$parent.resetPic=function(){t.ngModel=[]},a.on("click",function(){l.trigger("click")}),l.on("change",i)}}}angular.module("manageApp.upload").directive("uploaderOne",["alertError",t]).directive("uploader",e)}),define("upload/init",["angular"],function(){angular.module("manageApp.upload",[])}),define("project/controllers",["project/init"],function(){function e(e,t,a){t.closeAll(),e.addDataItem={},e.customerAddressReload=function(){e.reloadTime=(new Date).getTime(),t.closeAll()},e.customerAddressGetCallBack=function(e,t){e.customerName=t.name,e.contactsId||(e.contactsId=t.defaultContactId);for(var a=!1,n=0;n<t.contacts.length;n++)e.contactsId==t.contacts[n].id&&(a=!0);a||(e.contactsId=t.defaultContactId)},e.caifenQuantity=function(e,t){e.quantity_noInvoice_show=!0,t&&0===e.quantity_noInvoice&&e.quantity_Invoice>t&&(e.quantity_noInvoice=e.quantity_Invoice-t,e.quantity_Invoice=t)},e.selectRelIdCallBack=function(t){e.addDataItem.relId=t.id,e.addDataItem.name=t.name,e.addDataItem.brand=t.brand,e.addDataItem.unit=t.unit,e.addDataItem.price=t.price,e.addDataItem.isSameBatch="否",e.addDataItem.strike_price=t.price,e.addDataItem.headUrl=t.headUrl,e.addDataItem.specification=t.specification,e.addDataItem.manufacturer=t.manufacturer,$("#addDataItem_quantity").trigger("focus")},e.addDataItemClick=function(){return e.addDataItem.relId&&e.addDataItem.name?(e.formData.orderMedicalNos||(e.formData.orderMedicalNos=[]),e.formData.orderMedicalNos.push(e.addDataItem),e.addDataItem={},void $("input","#addDataItem_relId_chosen").trigger("focus")):void a("请选择药品。")},e.submitForm=function(t,a){"save"==a?e.formData.orderStatus="1":"submit"==a&&(e.formData.orderStatus="2"),$("#"+t).trigger("submit")},e.cancelForm=function(e,t){a("cancelForm")}}angular.module("manageApp.project").controller("salesOrderEditCtrl",["$scope","modal","alertWarn",e])}),define("project/directives",["project/init"],function(){angular.module("manageApp.project").directive("niceScroll",[function(){"use strict";return{restrict:"A",link:function(e,t,a){require(["nicescroll"],function(){$("html").niceScroll({styler:"fb",cursorcolor:"#65cea7",cursorwidth:"6",cursorborderradius:"0px",background:"#424f63",spacebarenabled:!1,cursorborder:"0",zindex:"1000"}),$("#page-side").niceScroll({styler:"fb",cursorcolor:"#65cea7",cursorwidth:"3",cursorborderradius:"0px",background:"#424f63",spacebarenabled:!1,cursorborder:"0"}),$("#page-side").getNiceScroll(),$("body").hasClass("left-side-collapsed")&&$("#page-side").getNiceScroll().hide()})}}}]).directive("leftMenuChange",[function(){"use strict";return{restrict:"A",link:function(e,t,a){t.on("click",function(){$(this).addClass("active").parent().siblings().each(function(){$(this).children().removeClass("active")})})}}}]).directive("orderStatusChoise",[function(){"use strict";return{restrict:"A",link:function(e,t,a){t.on("click",function(){$(this).addClass("pr-btn-bg-gold").siblings().each(function(){$(this).removeClass("pr-btn-bg-gold")}),$(this).parent().siblings().each(function(){$(this).children().each(function(){$(this).removeClass("pr-btn-bg-gold")})})})}}}]).directive("orderListTips",[function(){"use strict";return{restrict:"A",link:function(e,t,a){t.on("click",function(){$(this).hide(),$(this).siblings().show().on("click",function(){$(this).hide(),$(t).show()})})}}}]).directive("toggleLeftMenu",[function(){"use strict";return{restrict:"A",link:function(e,t,a){$(".toggle-btn").on("click",function(){$(".left-side").getNiceScroll().hide(),$("body").hasClass("left-side-collapsed")&&$(".left-side").getNiceScroll().hide();var e=$("body"),t=e.css("position");"relative"!=t?e.hasClass("left-side-collapsed")?(e.removeClass("left-side-collapsed chat-view"),$(".custom-nav li.active ul").css({display:"block"}),$(this).removeClass("menu-collapsed")):(e.addClass("left-side-collapsed"),$(".custom-nav ul").attr("style",""),$(this).addClass("menu-collapsed")):e.hasClass("left-side-show")?e.removeClass("left-side-show"):(e.addClass("left-side-show"),mainContentHeightAdjust())})}}}]).directive("togglePanel",[function(){"use strict";return{restrict:"A",link:function(e,t,a){$(".panel .tools .fa").on("click",function(){if($(this).hasClass("fa-times"))$(this).parents(".panel").parent().remove();else{var e=$(this).parents(".panel").children(".panel-body");$(this).hasClass("fa-chevron-down")?($(this).removeClass("fa-chevron-down").addClass("fa-chevron-up"),e.slideUp(200)):($(this).removeClass("fa-chevron-up").addClass("fa-chevron-down"),e.slideDown(200))}})}}}]).directive("morris",[function(){"use strict";return{restrict:"A",link:function(e,t,a){require(["morris"],function(){var e=a.id,t=[];if(angular.isDefined(a.datavalue)&&angular.isDefined(a.datalabel)&&angular.isDefined(a.dataformatted))for(var n={},i=0,r=a.datavalue.split(","),o=a.datalabel.split(","),l=a.dataformatted.split(",");i<r.length;)n.value=r[i],n.label=o[i],n.formatted=l[i],t.push(n),n={},i++;var s=!!angular.isDefined(a.backgroundColor)&&a.backgroundColor,c=angular.isDefined(a.labelColor)?a.labelColor:"#666",u=angular.isDefined(a.colors)?a.colors.split(","):["#ff5f39","#fe9302","#e39a27"];Morris.Donut({element:e,data:t,backgroundColor:s,labelColor:c,colors:u,formatter:function(e,t){return t.formatted}})})}}}]).directive("icheck",[function(){"use strict";return{restrict:"A",link:function(e,t,a){require(["icheck"],function(){function e(e){switch(e){case"minimal":$(".minimal input").iCheck({checkboxClass:"icheckbox_minimal",radioClass:"iradio_minimal",increaseArea:"20%"});break;case"minimal-red":$(".minimal-red input").iCheck({checkboxClass:"icheckbox_minimal-red",radioClass:"iradio_minimal-red",increaseArea:"20%"});break;case"minimal-green":$(".minimal-green input").iCheck({checkboxClass:"icheckbox_minimal-green",radioClass:"iradio_minimal-green",increaseArea:"20%"});break;case"minimal-blue":$(".minimal-blue input").iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue",increaseArea:"20%"});break;case"minimal-yellow":$(".minimal-yellow input").iCheck({checkboxClass:"icheckbox_minimal-yellow",radioClass:"iradio_minimal-yellow",increaseArea:"20%"});break;case"minimal-purple":$(".minimal-purple input").iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"});break;case"square":$(".square input").iCheck({checkboxClass:"icheckbox_square",radioClass:"iradio_square",increaseArea:"20%"});break;case"square-red":$(".square-red input").iCheck({checkboxClass:"icheckbox_square-red",radioClass:"iradio_square-red",increaseArea:"20%"});break;case"square-green":$(".square-green input").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green",increaseArea:"20%"});break;case"square-blue":$(".square-blue input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"});break;case"square-yellow":$(".square-yellow input").iCheck({checkboxClass:"icheckbox_square-yellow",radioClass:"iradio_square-yellow",increaseArea:"20%"});break;case"square-purple":$(".square-purple input").iCheck({checkboxClass:"icheckbox_square-purple",radioClass:"iradio_square-purple",increaseArea:"20%"});break;case"flat-red":$(".flat-red input").iCheck({checkboxClass:"icheckbox_flat-red",radioClass:"iradio_flat-red"});break;case"flat-grey":$(".flat-grey input").iCheck({checkboxClass:"icheckbox_flat-grey",radioClass:"iradio_flat-grey"});break;case"flat-green":$(".flat-green input").iCheck({checkboxClass:"icheckbox_flat-green",radioClass:"iradio_flat-green"});break;case"flat-blue":$(".flat-blue input").iCheck({checkboxClass:"icheckbox_flat-blue",radioClass:"iradio_flat-blue"});break;case"flat-yellow":$(".flat-yellow input").iCheck({checkboxClass:"icheckbox_flat-yellow",radioClass:"iradio_flat-yellow"});break;case"flat-purple":$(".flat-purple input").iCheck({checkboxClass:"icheckbox_flat-purple",radioClass:"iradio_flat-purple"})}}var t=a["class"],n=0,i=["minimal","minimal-red","minimal-green","minimal-blue","minimal-yellow","minimal-purple","square","square-red","square-green","square-blue","square-yellow","square-purple","flat-red","flat-grey","flat-green","flat-blue","flat-yellow","flat-purple"],r=i.length;for(n;n<r;n++)if(t.split(" ")[0]===i[n]){e(i[n]);break}})}}}]).directive("sparkline",[function(){"use strict";return{restrict:"A",link:function(e,t,a){require(["sparkline"],function(){$(".sparkline").each(function(){var e=$(this).data();e.valueSpots={"0:":e.spotColor},$(this).sparkline(e.data||"html",e,{tooltipFormat:'<span style="display:block; padding:0px 10px 12px 0px;"><span style="color: {{color}}">&#9679;</span> {{offset:names}} ({{percent.1}}%)</span>'})}),$("#income").sparkline([5,6,7,5,9,6,4,9,8,5,6,7],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#fc8675"}),$("#expense").sparkline([3,2,5,8,4,7,5,8,4,6],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#65cea7"}),$("#expense2").sparkline([3,2,5,8,4,7,5,8,4,6],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#65cea7"}),$("#pro-refund").sparkline([3,2,5,8,4,7,5,8,4,6],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#ffffff"}),$("#p-lead-1").sparkline([7,5,9,6,4,9,8,5,6,7],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#65cea7"}),$("#p-lead-2").sparkline([3,2,5,8,4,7,5,8,4,6],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#fc8675"}),$("#p-lead-3").sparkline([3,2,5,8,4,7,5,8,4,6],{type:"bar",height:"35",barWidth:5,barSpacing:2,barColor:"#5ab5de"}),$("#visit-1").sparkline([5,6,7,9,9,5,3,2,4,6,7,5,6,8,7,9,5],{type:"line",width:"100",height:"25",lineColor:"#55accc",fillColor:"#edf7f9"}),$("#visit-2").sparkline([5,6,7,7,9,5,8,5,4,6,7,8,6,8,7,9,5],{type:"line",width:"100",height:"25",lineColor:"#55accc",fillColor:"#edf7f9"})})}}}]).directive("runTooltips",[function(){"use strcit";return{restrict:"A",link:function(e,t,a){$("[data-toggle='tooltip']").tooltip()}}}]).directive("runPopovers",[function(){"use strict";return{restrict:"A",link:function(e,t,a){t.hasClass("popovers")&&$(t).popover({})}}}])}),define("project/filters",["project/init"],function(){angular.module("manageApp.project")}),define("project/init",["angular"],function(){angular.module("manageApp.project",[])}),define("project/registration",["angular"],function(){angular.module("manageApp.registration",[]).config(["$routeProvider",function(e){"use strict";e.when("/verify_phone",{templateUrl:"angular/tpl/registration/verify_phone.html",controller:"registrationCtrl"}).when("/send_info",{templateUrl:"angular/tpl/registration/send_info.html",controller:"registrationCtrl"}).when("/apply_bind",{templateUrl:"angular/tpl/registration/apply_bind.html",controller:"registrationCtrl"}).when("/bind_done",{templateUrl:"angular/tpl/registration/bind_done.html",controller:"registrationCtrl"}).otherwise({redirectTo:"/verify_phone"})}]).controller("registrationCtrl",["$scope","requestData",function(e,t){"use strict";e.globalData={requestUrlHead:""},e.sendRegVerifyCode=function(){if(e.regData.phone){var a=e.mainConfig.serverPath+"rest/sms/sendVerificationCode.json?isNewUser=true&tel="+e.regData.phone;t(a,{}).then(function(t){var a=t[0];e.validCode=a.code})["catch"](function(t){e.verifyResult.phone=!1,e.verifyResult.msg=t,"none"!==$(".reg-info-prompt").css("display")?e.verifyResult.msg=t:$(".reg-info-prompt").fadeIn(500)})}},e.bind_done=function(){window.location.assign("#/bind_done")},e.regSubmit=function(){if(e.regData){var a=e.mainConfig.serverPath+"rest/index/register",n=e.regData,i="POST";t(a,n,i).then(function(e){var t=e[1];200===t.code&&($(".reg-success-prompt").fadeIn(500),setTimeout(function(){window.location.href="#/apply_bind"},1500))})["catch"](function(t){e.verifyResult.phone=!1,e.verifyResult.msg=t,"none"!==$(".reg-info-prompt").css("display")?e.verifyResult.msg=t:$(".reg-info-prompt").fadeIn(500)})}}}]).filter("registrationFilter",[function(){}]).service("registrationService",[function(){}]).value("registrationValue",[function(){}]).directive("regCheckPhone",["$rootScope","requestData",function(e,t){"use strict";return{restrict:"A",require:"ngModel",link:function(a,n,i,r){e.verifyResult||(e.verifyResult={}),n.on("keyup",function(){if(11===$(n).val().length)if(r.$viewValue=$.trim(r.$viewValue),/^1(3|4|5|7|8)\d{9}$/.test(r.$viewValue)){var i=a.mainConfig.serverPath+"rest/index/user/isExist?phone="+r.$viewValue;t(i,{},"GET").then(function(t){200===t[1].code&&(e.verifyResult.phone=!0,e.verifyResult.phoneNumber=r.$viewValue,"none"!==$(".reg-info-prompt").css("display")&&$(".reg-info-prompt").fadeOut(200),"disabled"==$("#getVerifyCodeBtn").attr("disabled")&&$("#getVerifyCodeBtn").removeAttr("disabled"))})["catch"](function(t){e.verifyResult.phone=!1,e.verifyResult.msg=t,"none"!==$(".reg-info-prompt").css("display")?e.verifyResult.msg=t:($(".reg-info-prompt").fadeIn(500),$(n).focus())})}else e.verifyResult.phone=!1,e.verifyResult.msg="手机号码不能为空或格式不正确","none"===$(".reg-info-prompt").css("display")&&($(".reg-info-prompt").fadeIn(500),$(n).focus());else $("#getVerifyCodeBtn").attr("disabled","disabled"),$('button[type="submit"]').attr("disabled","disabled")})}}}]).directive("regCheckVerifyCode",["requestData","$rootScope",function(e,t){"use strict";return{restrict:"A",require:"ngModel",link:function(a,n,i,r){n.on("keyup",function(){var i=r.$viewValue.toString();if(4===i.length){var o=a.mainConfig.serverPath+"rest/sms/verifySmsCodey.json",l={tel:a.regData.phone,code:a.regData.verifyCode};e(o,l,"POST").then(function(e){200===e[1].code&&(t.verifyResult.verifyCode=!0,t.verifyResult.phone=!0,"none"!==$(".reg-info-prompt").css("display")&&$(".reg-info-prompt").fadeOut(200))})["catch"](function(e){t.verifyResult.verifyCode=!1,t.verifyResult.msg=e,"none"!==$(".reg-info-prompt").css("display")?t.verifyResult.msg=e:($(".reg-info-prompt").fadeIn(500),$(n).focus())})}})}}}]).directive("regCheckPassword",["$rootScope",function(e){"use strict";return{restrict:"A",require:"ngModel",link:function(t,a,n,i){e.verifyResult||(e.verifyResult={}),a.on("blur",function(){"password"===n.name&&(/[A-Za-z0-9_-]{6,32}/.test(i.$viewValue)?("none"!==$(".reg-info-prompt").css("display")&&$(".reg-info-prompt").fadeOut(200),e.verifyResult.password=!0):(e.verifyResult.password=!1,e.verifyResult.msg="密码应在6~32位之间且可包含大小写字母、数字、下划线和中划线","none"===$(".reg-info-prompt").css("display")&&($(".reg-info-prompt").fadeIn(500),$(a).focus()))),"repassword"===n.name&&(t.regData.password!==t.regData.repassword?(e.verifyResult.repassword=!1,e.verifyResult.msg="两次输入的密码不一致","none"===$(".reg-info-prompt").css("display")&&$(".reg-info-prompt").fadeIn(500)):("none"!==$(".reg-info-prompt").css("display")&&$(".reg-info-prompt").fadeOut(200),e.verifyResult.repassword=!0))})}}}]).directive("regCheckName",["$rootScope",function(e){"use strict";return{restrict:"A",require:"ngModel",link:function(t,a,n,i){e.verifyResult||(e.verifyResult={}),a.on("keydown",function(){var t=i.$viewValue;return void 0!==t&&t.length>16?(e.verifyResult.name=!1,e.verifyResult.msg="用户名为必填项且长度应在1~16位之间",void("none"===$(".reg-info-prompt").css("display")&&($(".reg-info-prompt").fadeIn(500),$(a).focus()))):(e.verifyResult.name=!0,void("none"!==$(".reg-info-prompt").css("display")&&$(".reg-info-prompt").fadeOut(200)))})}}}])}),define("project/services",["project/init"],function(){function e(){return function(e,t,a){var n='<div class="pr-top-dialog-tips" style="position:fixed;left:50%;top:0;opacity:0;height:42px;line-height:42px;padding:0 15px;color:#fff;background-color:#64c213;animation:topIn 1s;">'+test+"</div>";$(html).append(n)}}e.$inject=[],angular.module("manageApp.project").factory("proMessageTips",e)});